<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>为什么部署SSL证书后还是提示不安全 | MysticalYcc</title><meta name="keywords" content="服务器,ssl,网站,https"><meta name="author" content="MysticalYcc"><meta name="copyright" content="MysticalYcc"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="很多朋友可能都会遇到这个让人抓狂的问题：为什么按要求部署SSL证书了，但访问网站时还是会出现不安全的提示？这里就和大家一起来看看可能导致这个问题的原因和解决方法。">
<meta property="og:type" content="article">
<meta property="og:title" content="为什么部署SSL证书后还是提示不安全">
<meta property="og:url" content="https://gschaos.club/%E4%B8%BA%E4%BB%80%E4%B9%88%E9%83%A8%E7%BD%B2SSL%E8%AF%81%E4%B9%A6%E5%90%8E%EF%BC%8C%E8%BF%98%E6%98%AF%E6%8F%90%E7%A4%BA%E4%B8%8D%E5%AE%89%E5%85%A8/index.html">
<meta property="og:site_name" content="MysticalYcc">
<meta property="og:description" content="很多朋友可能都会遇到这个让人抓狂的问题：为什么按要求部署SSL证书了，但访问网站时还是会出现不安全的提示？这里就和大家一起来看看可能导致这个问题的原因和解决方法。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://mysticalyu.gitee.io/pic/img/aniraiden-wu-final003-00000.jpg">
<meta property="article:published_time" content="2020-09-08T16:00:00.000Z">
<meta property="article:modified_time" content="2020-09-27T08:48:00.000Z">
<meta property="article:author" content="MysticalYcc">
<meta property="article:tag" content="服务器">
<meta property="article:tag" content="ssl">
<meta property="article:tag" content="网站">
<meta property="article:tag" content="https">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://mysticalyu.gitee.io/pic/img/aniraiden-wu-final003-00000.jpg"><link rel="shortcut icon" href="/ico/favicon.ico"><link rel="canonical" href="https://gschaos.club/%E4%B8%BA%E4%BB%80%E4%B9%88%E9%83%A8%E7%BD%B2SSL%E8%AF%81%E4%B9%A6%E5%90%8E%EF%BC%8C%E8%BF%98%E6%98%AF%E6%8F%90%E7%A4%BA%E4%B8%8D%E5%AE%89%E5%85%A8/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  hexoversion: '5.1.1',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true,
  postUpdate: '2020-09-27 16:48:00'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
  }
}

var autoChangeMode = 'false'
var t = saveToLocal.get('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (saveToLocal.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><meta name="generator" content="Hexo 5.1.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://gschaos.club/ico/me.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">44</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">29</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">17</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-camera-retro"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-images"></i><span> 画廊</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%83%A8%E7%BD%B2SSL%E8%AF%81%E4%B9%A6%E5%90%8E%EF%BC%8C%E8%BF%98%E6%98%AF%E6%8F%90%E7%A4%BA%E4%B8%8D%E5%AE%89%E5%85%A8"><span class="toc-number">1.</span> <span class="toc-text">为什么部署SSL证书后，还是提示不安全</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%9F%E5%90%8D%E4%B8%8D%E5%8C%B9%E9%85%8D"><span class="toc-number">1.0.1.</span> <span class="toc-text">域名不匹配</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%81%E4%B9%A6%E5%88%B0%E6%9C%9F"><span class="toc-number">1.0.2.</span> <span class="toc-text">证书到期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E9%94%99%E8%AF%AF"><span class="toc-number">1.0.3.</span> <span class="toc-text">系统时间错误</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E5%8F%97%E4%BF%A1%E4%BB%BB%E7%9A%84SSL%E8%AF%81%E4%B9%A6"><span class="toc-number">1.0.4.</span> <span class="toc-text">不受信任的SSL证书</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AB%99%E5%86%85%E8%B0%83%E7%94%A8%E9%9D%9EHTTPS%E7%B4%A0%E6%9D%90"><span class="toc-number">1.0.5.</span> <span class="toc-text">站内调用非HTTPS素材</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E6%B7%B7%E5%90%88%E5%86%85%E5%AE%B9%EF%BC%9F"><span class="toc-number">2.</span> <span class="toc-text">什么是混合内容？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#TL-DR"><span class="toc-number">2.0.1.</span> <span class="toc-text">TL;DR</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B5%84%E6%BA%90%E8%AF%B7%E6%B1%82%E5%92%8C%E7%BD%91%E7%BB%9C%E6%B5%8F%E8%A7%88%E5%99%A8"><span class="toc-number">2.1.</span> <span class="toc-text">资源请求和网络浏览器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTPS-%E7%9A%84%E4%BC%98%E5%8A%BF"><span class="toc-number">2.2.</span> <span class="toc-text">HTTPS 的优势</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81"><span class="toc-number">2.2.1.</span> <span class="toc-text">身份验证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7"><span class="toc-number">2.2.2.</span> <span class="toc-text">数据完整性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%9D%E5%AF%86%E6%80%A7"><span class="toc-number">2.2.3.</span> <span class="toc-text">保密性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTPS%E3%80%81%E4%BC%A0%E8%BE%93%E5%B1%82%E5%AE%89%E5%85%A8%E5%8D%8F%E8%AE%AE-TLS-%E5%92%8C-SSL"><span class="toc-number">2.2.4.</span> <span class="toc-text">HTTPS、传输层安全协议 (TLS) 和 SSL</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%B7%E5%90%88%E5%86%85%E5%AE%B9%E4%BC%9A%E9%99%8D%E4%BD%8E-HTTPS-%E7%9A%84%E5%AE%89%E5%85%A8%E6%80%A7"><span class="toc-number">2.3.</span> <span class="toc-text">混合内容会降低 HTTPS 的安全性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E7%A4%BA%E4%BE%8B"><span class="toc-number">2.3.1.</span> <span class="toc-text">一个简单的示例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E4%B8%AA-XMLHttpRequest-%E7%A4%BA%E4%BE%8B"><span class="toc-number">2.3.2.</span> <span class="toc-text">一个 XMLHttpRequest 示例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E5%83%8F%E5%BA%93%E7%A4%BA%E4%BE%8B"><span class="toc-number">2.3.3.</span> <span class="toc-text">图像库示例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%B7%E5%90%88%E5%86%85%E5%AE%B9%E7%B1%BB%E5%9E%8B%E4%B8%8E%E7%9B%B8%E5%85%B3%E5%AE%89%E5%85%A8%E5%A8%81%E8%83%81"><span class="toc-number">2.4.</span> <span class="toc-text">混合内容类型与相关安全威胁</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A2%AB%E5%8A%A8%E6%B7%B7%E5%90%88%E5%86%85%E5%AE%B9"><span class="toc-number">2.4.1.</span> <span class="toc-text">被动混合内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E5%8A%A8%E6%B7%B7%E5%90%88%E5%86%85%E5%AE%B9"><span class="toc-number">2.4.2.</span> <span class="toc-text">主动混合内容</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B7%E6%9C%89%E6%B7%B7%E5%90%88%E5%86%85%E5%AE%B9%E7%9A%84%E6%B5%8F%E8%A7%88%E5%99%A8%E8%A1%8C%E4%B8%BA"><span class="toc-number">2.5.</span> <span class="toc-text">具有混合内容的浏览器行为</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E7%89%88%E6%9C%AC"><span class="toc-number">2.5.1.</span> <span class="toc-text">浏览器版本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E5%B0%91%E4%B8%AD%E9%97%B4%E6%A0%B9%E8%AF%81%E4%B9%A6"><span class="toc-number">2.5.2.</span> <span class="toc-text">缺少中间根证书</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%96%87%E7%AB%A0%EF%BC%9A"><span class="toc-number">2.5.3.</span> <span class="toc-text">相关文章：</span></a></li></ol></li></ol></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(https://mysticalyu.gitee.io/pic/img/aniraiden-wu-final003-00000.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">MysticalYcc</a></span><span id="menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-camera-retro"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-images"></i><span> 画廊</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">为什么部署SSL证书后还是提示不安全</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-09-08T16:00:00.000Z" title="发表于 2020-09-09 00:00:00">2020-09-09</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2020-09-27T08:48:00.000Z" title="更新于 2020-09-27 16:48:00">2020-09-27</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BD%91%E7%AB%99/">网站</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><p>很多朋友可能都会遇到这个让人抓狂的问题：为什么按要求部署SSL证书了，但访问网站时还是会出现不安全的提示？这里就和大家一起来看看可能导致这个问题的原因和解决方法。</p>
 <a id="more"></a>



<h1 id="为什么部署SSL证书后，还是提示不安全"><a href="#为什么部署SSL证书后，还是提示不安全" class="headerlink" title="为什么部署SSL证书后，还是提示不安全"></a>为什么部署SSL证书后，还是提示不安全</h1><p>很多朋友可能都会遇到这个让人抓狂的问题：为什么按要求部署SSL证书了，但访问网站时还是会出现不安全的提示？这里<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.bisend.cn/">必盛云</a>就和大家一起来看看可能导致这个问题的原因和解决方法。</p>
<p>首先我们来看看为什么会出现不安全提示：</p>
<p>当我们访问一个已安装<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.bisend.cn/ssl-certificate">SSL证书</a>的网站页面时，如果页面出现”您的连接不是私密链接“或”此网页含有不安全的内容“等类似的错误提示，这说明浏览器检查到你当前所访问的HTTPS网站的SSL证书出现问题了，存在访问风险，所以提示用户“此站点不安全”。</p>
<p>那么这个问题是怎么出现的呢？要怎样才能解决呢？请看下面的分析：</p>
<h3 id="域名不匹配"><a href="#域名不匹配" class="headerlink" title="域名不匹配"></a>域名不匹配</h3><p>HTTPS网站其中一个非常重要的作用，就是确认网站的身份。这样就能非常有效地预防DNS劫持。一张SSL证书必须对应一个网站域名，当你访问的网站域名和SSL证书中设置的域名不一致时，浏览器就会提示用户网站不安全。可能是由于配置错误导致SSL证书与网站域名不配置，也可能因为多个域名都能使用同一张SSL证书，导致域名与SSL证书不匹配。</p>
<p>此种情况下，需要站长确认域名与所部署的SSL证书是否相匹配，如不匹配需及时替换为正确的证书。</p>
<h3 id="证书到期"><a href="#证书到期" class="headerlink" title="证书到期"></a>证书到期</h3><p>这个原因非常好理解，即您的SSL证书到期需要续费重新申请了； SSL证书过期也是导致出现错误的原因之一。一般SSL证书的有效期为1~2年，当证书过期后，就必须要更新证书，HTTPS网站才能继续正常工作。否则过了有效期就会提示错误。可能有的站长管理很多网站，在证书到期之后重新安装会非常耗时，希望申请证书的有效期能长一点，但从CA（Certificate Authority证书颁发机构）的角度来看，设置证书有效期是非常有必要的。</p>
<p>首先是为了安全考虑，CA机构不能保证一个网站永远是合法的，因此它需要定期检查网站。其次，涉及到证书吊销。当网站的私钥丢失时，网站应该向CA申请将他们的证书加入到证书吊销列表（CRL）里。当用户访问https站点时，浏览器会自动向CA请求吊销列表，如果用户访问的站点提供的证书在CRL里，浏览器就不信任这个证书，因为攻击者可能拥有同样的证书。所以如果证书永久有效，随着越来越多的私钥丢失，吊销列表也越来越大，因为只有加进去的，没有剔出去的，这既给CA增加流量压力，也会增加浏览器的流量。而一旦有效期只有几年，那么CA就可以将那些已经过期了的证书从CRL里剔除，因为反正浏览器也不信任过期证书。</p>
<h3 id="系统时间错误"><a href="#系统时间错误" class="headerlink" title="系统时间错误"></a>系统时间错误</h3><p>另外一个常见的原因，是客户端的系统时间错误。浏览器会判断SSL证书是否过期，而浏览器的时间判断是依照你的系统时间。假如你的系统时间不正确，那么很有可能浏览器就会出现误判的情况，导致一张还没过期的SSL证书被认为是过期了。最终页面显示错误提示。解决办法也非常简单，修改您的系统时间为正确的就可以了。</p>
<h3 id="不受信任的SSL证书"><a href="#不受信任的SSL证书" class="headerlink" title="不受信任的SSL证书"></a>不受信任的SSL证书</h3><p>一些站长或者个人站长由于经费上的预算有限，又恰好懂得一些代码，自己制作出一张自签名的SSL证书或向一些SSL证书服务商申请不受信任的SSL证书。但现在浏览器对SSL证书的管理也更加严格，这些使用自签名SSL证书或不受信任的SSL证书部署的网站是不被浏览器信任的，所以访问时仍然会出现错误提示。因为自签名证书或小型SSL证书并不在操作系统的可信任根证书之中。只有是由受信任根证书所签发出来的SSL证书，浏览器才会认为是安全的，其他的SSL证书浏览器一律都会提示错误。</p>
<h3 id="站内调用非HTTPS素材"><a href="#站内调用非HTTPS素材" class="headerlink" title="站内调用非HTTPS素材"></a>站内调用非HTTPS素材</h3><p>站内调用非HTTPS素材包括图文、CSS、js等素材。出现这种情形时，一般在浏览器安全锁处会看到锁出现了一个三角形图形，点击查看SSL证书详细信息能看到有感叹号说明。下面我们就来看看如何解决这一问题：</p>
<p>首先您可以通过按住键盘上的F12键进入开发者模式，或者鼠标放在页面空白处点击右键后选择“查看网页源代码”，之后就可以在右侧边框找是哪些非安全链接导至整个网站不被信任。</p>
<p><img src="https://www.bisend.cn/blog/wp-content/uploads/2019/09/1.jpeg" alt="img"></p>
<p>查看上图中找到的两个链接，的确是http的素材路径。</p>
<p><img src="https://www.bisend.cn/blog/wp-content/uploads/2019/09/2.jpeg" alt="img"></p>
<p>那么现在我们需要做的就是检查这两个链接是否为有用链接；如果这个链接没有什么作用，删掉也不会对网站有任何影响，那么直接删除就行了。然后继续检查直至清除所有无用的非安全链接。完成清理后，再清除浏览器缓存，则可以看到网站已经重新被浏览器信任了。</p>
<p><img src="https://www.bisend.cn/blog/wp-content/uploads/2019/09/u20jw3wl6p.jpeg" alt="img"></p>
<p>现在再来看看第二种情况，如果这个元素或图片/CSS/JS是对网站极为重要的内容，绝对不可以删除。此时，则只需把源站的非安全素材的路径由绝对路径放置在本站文件夹变成相对路径。</p>
<h1 id="什么是混合内容？"><a href="#什么是混合内容？" class="headerlink" title="什么是混合内容？"></a>什么是混合内容？</h1><p><strong>混合内容</strong>在以下情况下出现：初始 HTML 内容通过安全的 HTTPS 连接加载，但其他资源（例如，图像、视频、样式表、脚本）则通过不安全的 HTTP 连接加载。之所以称为混合内容，是因为同时加载了 HTTP 和 HTTPS 内容以显示同一个页面，且通过 HTTPS 加载的初始请求是安全的。现代浏览器会针对此类型的内容显示警告，以向用户表明此页面包含不安全的资源。</p>
<h3 id="TL-DR"><a href="#TL-DR" class="headerlink" title="TL;DR"></a>TL;DR</h3><ul>
<li>HTTPS 对于保护您的网站和用户免受攻击非常重要。</li>
<li>混合内容会降低您的 HTTPS 网站的安全性和用户体验。</li>
</ul>
<h2 id="资源请求和网络浏览器"><a href="#资源请求和网络浏览器" class="headerlink" title="资源请求和网络浏览器"></a>资源请求和网络浏览器</h2><p>当浏览器访问网站的页面时，它将请求 HTML 资源。然后，网络服务器返回 HTML 内容，浏览器进行解析并显示给用户。通常，一个 HTML 文件不足以显示一个完整页面，因此，HTML 文件包含浏览器需要请求的其他资源的引用。这些子资源可以是图像、视频、额外 HTML、CSS 或 JavaScript 之类的资源；每个资源均使用单独的请求获取。</p>
<h2 id="HTTPS-的优势"><a href="#HTTPS-的优势" class="headerlink" title="HTTPS 的优势"></a>HTTPS 的优势</h2><p>当浏览器通过 HTTPS（HTTP Secure 的缩写形式）请求资源时，它使用一个已加密连接与网络服务器进行通信。</p>
<p>使用 HTTPS 有三个主要优势：</p>
<ul>
<li>身份验证</li>
<li>数据完整性</li>
<li>保密性</li>
</ul>
<h3 id="身份验证"><a href="#身份验证" class="headerlink" title="身份验证"></a>身份验证</h3><p>我正在访问的网站是正确的吗？</p>
<p>HTTPS 让浏览器检查并确保其已打开正确的网站，并且没有被重定向到恶意的网站。 当导航到您的银行网站时，您的浏览器对该网站进行身份验证，从而防止攻击者冒充您的银行窃取您的登录凭据。</p>
<h3 id="数据完整性"><a href="#数据完整性" class="headerlink" title="数据完整性"></a>数据完整性</h3><p>是否有人篡改我正在发送或接收的内容？</p>
<p>HTTPS 让浏览器检测是否有攻击者更改了浏览器接收的任何数据。 使用您的银行网站转账时，这样做可防止当您的请求在传输中时攻击者更改目标帐号。</p>
<h3 id="保密性"><a href="#保密性" class="headerlink" title="保密性"></a>保密性</h3><p>是否有人能看到我正在发送或接收的内容？</p>
<p>HTTPS 可防止攻击者窃取浏览器的请求，跟踪访问的网站或窃取已发送或接收的信息。</p>
<h3 id="HTTPS、传输层安全协议-TLS-和-SSL"><a href="#HTTPS、传输层安全协议-TLS-和-SSL" class="headerlink" title="HTTPS、传输层安全协议 (TLS) 和 SSL"></a>HTTPS、传输层安全协议 (TLS) 和 SSL</h3><p>HTTPS 是 HTTP Secure 的缩写，即超文本传输安全协议。此处的 <strong>secure</strong> 部分来自于添加到浏览器发送和接收的请求的加密。目前大多数浏览器都使用传输层安全协议 (TLS) 提供加密；<strong>TLS</strong> 有时称为 SSL。</p>
<ul>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://en.wikipedia.org/wiki/HTTPS">Wikipedia HTTPS</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://en.wikipedia.org/wiki/Transport_Layer_Security">Wikipedia TLS</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.khanacademy.org/computing/computer-science/cryptography">可汗学院 (Khan Academy) 的加密课程</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hpbn.co/">高性能浏览器网络</a>（作者：Ilya Grigorik）中的<a target="_blank" rel="noopener external nofollow noreferrer" href="https://hpbn.co/transport-layer-security-tls/">传输层安全协议 (TLS) 章节</a></li>
</ul>
<h2 id="混合内容会降低-HTTPS-的安全性"><a href="#混合内容会降低-HTTPS-的安全性" class="headerlink" title="混合内容会降低 HTTPS 的安全性"></a>混合内容会降低 HTTPS 的安全性</h2><p>使用不安全的 HTTP 协议请求子资源会降低整个页面的安全性，因为这些请求容易受到<strong>中间人攻击</strong>，攻击者窃听网络连接，查看或修改双方的通信。通过使用这些资源，攻击者通常可以完全控制页面，而不只是泄露的资源。</p>
<p>尽管许多浏览器向用户报告混合内容警告，但出现警告时为时已晚：不安全的请求已被执行，且页面的安全性被破坏。遗憾的是，这种情况在网络中很普遍，正因如此，浏览器不能简单地阻止所有混合请求，否则将会限制许多网站的功能。</p>
<p><img src="https://developers.google.com/web/fundamentals/security/prevent-mixed-content/imgs/image-gallery-warning.png?hl=zh-cn" alt="混合内容：页面已通过 HTTPS 加载，但请求了不安全的图像。此内容也应通过 HTTPS 提供。">修正应用中的混合内容问题是开发者的责任。</p>
<h3 id="一个简单的示例"><a href="#一个简单的示例" class="headerlink" title="一个简单的示例"></a>一个简单的示例</h3><p>从 HTTPS 页面加载不安全的脚本。</p>
<p>查看通过 <strong>HTTPS</strong>—<a target="_blank" rel="noopener external nofollow noreferrer" href="https://googlesamples.github.io/web-fundamentals/fundamentals/security/prevent-mixed-content/simple-example.html"><strong>https</strong>://googlesamples.github.io/web-fundamentals/…/simple-example.html</a>加载的此示例页面 — 添加一个 <strong>HTTP</strong> 脚本标记，其尝试加载混合内容。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta charset&#x3D;&quot;utf-8&quot;&gt;</span><br><span class="line">    &lt;meta http-equiv&#x3D;&quot;X-UA-Compatible&quot; content&#x3D;&quot;IE&#x3D;edge&quot;&gt;</span><br><span class="line">    &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1&quot;&gt;</span><br><span class="line">    &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;https:&#x2F;&#x2F;fonts.googleapis.com&#x2F;icon?family&#x3D;Material+Icons&quot;&gt;</span><br><span class="line">    &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;https:&#x2F;&#x2F;code.getmdl.io&#x2F;1.2.1&#x2F;material.indigo-pink.min.css&quot;&gt;</span><br><span class="line">    &lt;script defer src&#x3D;&quot;https:&#x2F;&#x2F;code.getmdl.io&#x2F;1.2.1&#x2F;material.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">      body &#123;</span><br><span class="line">        margin: 2em;</span><br><span class="line">      &#125;</span><br><span class="line">    &lt;&#x2F;style&gt;</span><br><span class="line">    &lt;title&gt;Simple mixed content example&lt;&#x2F;title&gt;</span><br><span class="line">  &lt;&#x2F;head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;div role&#x3D;&quot;main&quot;&gt;</span><br><span class="line">      &lt;h1&gt;</span><br><span class="line">        Simple mixed content example!</span><br><span class="line">      &lt;&#x2F;h1&gt;</span><br><span class="line">      &lt;p&gt;</span><br><span class="line">        View page over: &lt;a href&#x3D;&quot;http:&#x2F;&#x2F;googlesamples.github.io&#x2F;web-fundamentals&#x2F;fundamentals&#x2F;security&#x2F;prevent-mixed-content&#x2F;simple-example.html&quot;&gt;HTTP&lt;&#x2F;a&gt; - &lt;a href&#x3D;&quot;https:&#x2F;&#x2F;googlesamples.github.io&#x2F;web-fundamentals&#x2F;fundamentals&#x2F;security&#x2F;prevent-mixed-content&#x2F;simple-example.html&quot;&gt;HTTPS&lt;&#x2F;a&gt;</span><br><span class="line">      &lt;&#x2F;p&gt;</span><br><span class="line">      &lt;p&gt;</span><br><span class="line">        This page loads the script simple-example.js using HTTP. This is the simplest case of mixed content. When the simple-example.js file is requested by the browser, an attacker can inject code into the returned content and take control of the entire page. Thankfully, most modern browsers block this type of dangerous content by default and display an error in the JavaScript console. This can be seen when the page is viewed over HTTPS.</span><br><span class="line">      &lt;&#x2F;p&gt;</span><br><span class="line">      &lt;div id&#x3D;&quot;output&quot;&gt;Waiting for insecure script to run...&lt;&#x2F;div&gt;</span><br><span class="line">      &lt;script src&#x3D;&quot;http:&#x2F;&#x2F;googlesamples.github.io&#x2F;web-fundamentals&#x2F;fundamentals&#x2F;security&#x2F;prevent-mixed-content&#x2F;simple-example.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">  (function(b,o,i,l,e,r)&#123;b.GoogleAnalyticsObject&#x3D;l;b[l]||(b[l]&#x3D;</span><br><span class="line">  function()&#123;(b[l].q&#x3D;b[l].q||[]).push(arguments)&#125;);b[l].l&#x3D;+new Date;</span><br><span class="line">  e&#x3D;o.createElement(i);r&#x3D;o.getElementsByTagName(i)[0];</span><br><span class="line">  e.src&#x3D;&#39;https:&#x2F;&#x2F;www.google-analytics.com&#x2F;analytics.js&#39;;</span><br><span class="line">  r.parentNode.insertBefore(e,r)&#125;(window,document,&#39;script&#39;,&#39;ga&#39;));</span><br><span class="line">  ga(&#39;create&#39;,&#39;UA-52746336-1&#39;);ga(&#39;send&#39;,&#39;pageview&#39;);</span><br><span class="line">  var isCompleted &#x3D; &#123;&#125;;</span><br><span class="line">  function sampleCompleted(sampleName)&#123;</span><br><span class="line">    if (ga &amp;&amp; !isCompleted.hasOwnProperty(sampleName)) &#123;</span><br><span class="line">      ga(&#39;send&#39;, &#39;event&#39;, &#39;WebCentralSample&#39;, sampleName, &#39;completed&#39;); </span><br><span class="line">      isCompleted[sampleName] &#x3D; true;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line">  &lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://googlesamples.github.io/web-fundamentals/fundamentals/security/prevent-mixed-content/simple-example.html">试一下</a></p>
<p>在此示例中，使用一个 <strong>HTTP</strong> 网址加载脚本 <code>simple-example.js</code>。这是最简单的混合内容案例。浏览器请求 <code>simple-example.js</code> 文件时，攻击者可以将代码注入返回的内容，并控制整个页面。</p>
<p>幸运的是，大多数现代浏览器均默认阻止此类危险的内容。 请参阅<a target="_blank" rel="noopener external nofollow noreferrer" href="https://developers.google.com/web/fundamentals/security/prevent-mixed-content/what-is-mixed-content?hl=zh-cn#browser-behavior-with-mixed-content">具有混合内容的浏览器行为</a>。</p>
<p><img src="https://developers.google.com/web/fundamentals/security/prevent-mixed-content/imgs/simple-mixed-content-error.png?hl=zh-cn" alt="混合内容：页面已通过 HTTPS 加载，但请求了不安全的脚本。此请求已被阻止，内容必须通过 HTTPS 提供。">Chrome 可阻止不安全的脚本。</p>
<h3 id="一个-XMLHttpRequest-示例"><a href="#一个-XMLHttpRequest-示例" class="headerlink" title="一个 XMLHttpRequest 示例"></a>一个 XMLHttpRequest 示例</h3><p>通过 XMLHttpRequest 加载不安全的数据。</p>
<p>查看通过 <strong>HTTPS</strong>—<a target="_blank" rel="noopener external nofollow noreferrer" href="https://googlesamples.github.io/web-fundamentals/fundamentals/security/prevent-mixed-content/xmlhttprequest-example.html"><strong>https</strong>://googlesamples.github.io/web-fundamentals/…/xmlhttprequest-example.html</a> 加载的此示例页面 — 添加一个通过 <strong>HTTP</strong> 加载的<code>XMLHttpRequest</code>，以获取混合内容 <code>JSON</code> 数据。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta charset&#x3D;&quot;utf-8&quot;&gt;</span><br><span class="line">    &lt;meta http-equiv&#x3D;&quot;X-UA-Compatible&quot; content&#x3D;&quot;IE&#x3D;edge&quot;&gt;</span><br><span class="line">    &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1&quot;&gt;</span><br><span class="line">    &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;https:&#x2F;&#x2F;fonts.googleapis.com&#x2F;icon?family&#x3D;Material+Icons&quot;&gt;</span><br><span class="line">    &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;https:&#x2F;&#x2F;code.getmdl.io&#x2F;1.2.1&#x2F;material.indigo-pink.min.css&quot;&gt;</span><br><span class="line">    &lt;script defer src&#x3D;&quot;https:&#x2F;&#x2F;code.getmdl.io&#x2F;1.2.1&#x2F;material.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">      body &#123;</span><br><span class="line">        margin: 2em;</span><br><span class="line">      &#125;</span><br><span class="line">    &lt;&#x2F;style&gt;</span><br><span class="line">    &lt;title&gt;XMLHttpRequest mixed content example&lt;&#x2F;title&gt;</span><br><span class="line">  &lt;&#x2F;head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;div role&#x3D;&quot;main&quot;&gt;</span><br><span class="line">      &lt;h1&gt;</span><br><span class="line">        XMLHttpRequest mixed content example!</span><br><span class="line">      &lt;&#x2F;h1&gt;</span><br><span class="line">      &lt;p&gt;</span><br><span class="line">        View page over: &lt;a href&#x3D;&quot;http:&#x2F;&#x2F;googlesamples.github.io&#x2F;web-fundamentals&#x2F;fundamentals&#x2F;security&#x2F;prevent-mixed-content&#x2F;xmlhttprequest-example.html&quot;&gt;HTTP&lt;&#x2F;a&gt; - &lt;a href&#x3D;&quot;https:&#x2F;&#x2F;googlesamples.github.io&#x2F;web-fundamentals&#x2F;fundamentals&#x2F;security&#x2F;prevent-mixed-content&#x2F;xmlhttprequest-example.html&quot;&gt;HTTPS&lt;&#x2F;a&gt;</span><br><span class="line">      &lt;&#x2F;p&gt;</span><br><span class="line">      &lt;p&gt;</span><br><span class="line">        This page constructs an HTTP URL dynamically in JavaScript, the URL is eventually used to load an insecure resource by XMLHttpRequest. When the xmlhttprequest-data.js file is requested by the browser, an attacker can inject code into the returned content and take control of the entire page. Thankfully, most modern browsers block this type of dangerous content by default and display an error in the JavaScript console. This can be seen when the page is viewed over HTTPS.</span><br><span class="line">      &lt;&#x2F;p&gt;</span><br><span class="line">      &lt;div id&#x3D;&quot;output&quot;&gt;Waiting for data...&lt;&#x2F;div&gt;</span><br><span class="line">      &lt;script&gt;</span><br><span class="line">        var rootUrl &#x3D; &#39;http:&#x2F;&#x2F;googlesamples.github.io&#x2F;web-fundamentals&#x2F;fundamentals&#x2F;security&#x2F;prevent-mixed-content&#39;;</span><br><span class="line">        var resources &#x3D; &#123;</span><br><span class="line">          jsonData: &#39;&#x2F;xmlhttprequest-data.js&#39;</span><br><span class="line">        &#125;;</span><br><span class="line">        var request &#x3D; new XMLHttpRequest();</span><br><span class="line">        request.addEventListener(&#39;load&#39;, function() &#123;</span><br><span class="line">          var jsonData &#x3D; JSON.parse(request.responseText);</span><br><span class="line">          document.getElementById(&#39;output&#39;).innerHTML +&#x3D; &#39;&lt;br&gt;&#39; + jsonData.data;</span><br><span class="line">        &#125;);</span><br><span class="line">        request.open(&#39;GET&#39;, rootUrl + resources.jsonData, true);</span><br><span class="line">        request.send();</span><br><span class="line">      &lt;&#x2F;script&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">  (function(b,o,i,l,e,r)&#123;b.GoogleAnalyticsObject&#x3D;l;b[l]||(b[l]&#x3D;</span><br><span class="line">  function()&#123;(b[l].q&#x3D;b[l].q||[]).push(arguments)&#125;);b[l].l&#x3D;+new Date;</span><br><span class="line">  e&#x3D;o.createElement(i);r&#x3D;o.getElementsByTagName(i)[0];</span><br><span class="line">  e.src&#x3D;&#39;&#x2F;&#x2F;www.google-analytics.com&#x2F;analytics.js&#39;;</span><br><span class="line">  r.parentNode.insertBefore(e,r)&#125;(window,document,&#39;script&#39;,&#39;ga&#39;));</span><br><span class="line">  ga(&#39;create&#39;,&#39;UA-52746336-1&#39;);ga(&#39;send&#39;,&#39;pageview&#39;);</span><br><span class="line">  var isCompleted &#x3D; &#123;&#125;;</span><br><span class="line">  function sampleCompleted(sampleName)&#123;</span><br><span class="line">    if (ga &amp;&amp; !isCompleted.hasOwnProperty(sampleName)) &#123;</span><br><span class="line">      ga(&#39;send&#39;, &#39;event&#39;, &#39;WebCentralSample&#39;, sampleName, &#39;completed&#39;); </span><br><span class="line">      isCompleted[sampleName] &#x3D; true;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line">  &lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://googlesamples.github.io/web-fundamentals/fundamentals/security/prevent-mixed-content/xmlhttprequest-example.html">试一下</a></p>
<p>下面的 <strong>HTTP</strong> 网址是在 JavaScript 中动态构建的，并且最终被 <code>XMLHttpRequest</code> 用于加载不安全的资源。 与上面简单的示例相似，当浏览器请求 <code>xmlhttprequest-data.js</code> 文件时，攻击者可以将代码注入返回的内容中，并控制整个页面。</p>
<p>大多数现代浏览器也会阻止这些危险的请求。</p>
<p><img src="https://developers.google.com/web/fundamentals/security/prevent-mixed-content/imgs/xmlhttprequest-mixed-content-error.png?hl=zh-cn" alt="混合内容：页面已通过 HTTPS 加载，但请求了不安全的 XMLHttpRequest 端点。此请求已被阻止，内容必须通过 HTTPS 提供。">Chrome 可阻止不安全的 XMLHttpRequest。</p>
<h3 id="图像库示例"><a href="#图像库示例" class="headerlink" title="图像库示例"></a>图像库示例</h3><p>使用 jQuery 灯箱加载不安全的图像。</p>
<p>查看通过 <strong>HTTPS</strong>—<a target="_blank" rel="noopener external nofollow noreferrer" href="https://googlesamples.github.io/web-fundamentals/fundamentals/security/prevent-mixed-content/image-gallery-example.html"><strong>https</strong>://googlesamples.github.io/web-fundamentals/…/image-gallery-example.html</a> 加载的此示例页面时 — 最初没有任何混合内容问题；但是当点击缩略图时，将通过 <strong>HTTP</strong> 加载完整尺寸的混合内容图像。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta charset&#x3D;&quot;utf-8&quot;&gt;</span><br><span class="line">    &lt;meta http-equiv&#x3D;&quot;X-UA-Compatible&quot; content&#x3D;&quot;IE&#x3D;edge&quot;&gt;</span><br><span class="line">    &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1&quot;&gt;</span><br><span class="line">    &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;https:&#x2F;&#x2F;fonts.googleapis.com&#x2F;icon?family&#x3D;Material+Icons&quot;&gt;</span><br><span class="line">    &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;https:&#x2F;&#x2F;code.getmdl.io&#x2F;1.2.1&#x2F;material.indigo-pink.min.css&quot;&gt;</span><br><span class="line">    &lt;script defer src&#x3D;&quot;https:&#x2F;&#x2F;code.getmdl.io&#x2F;1.2.1&#x2F;material.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">      body &#123;</span><br><span class="line">        margin: 2em;</span><br><span class="line">      &#125;</span><br><span class="line">    &lt;&#x2F;style&gt;</span><br><span class="line">    &lt;title&gt;Image gallery mixed content example&lt;&#x2F;title&gt;</span><br><span class="line">    &lt;script src&#x3D;&quot;https:&#x2F;&#x2F;www.gstatic.com&#x2F;external_hosted&#x2F;jquery2.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">      $(function() &#123;</span><br><span class="line">        $(&#39;.gallery&#39;).click(function(e) &#123;</span><br><span class="line">          e.preventDefault();</span><br><span class="line">          $(&#39;.overlay-foreground&#39;).css(&#39;background-image&#39;, &#39;url(&#39; + $(this).attr(&#39;href&#39;) + &#39;)&#39;);</span><br><span class="line">          $(&#39;.overlay&#39;).fadeIn(&#39;slow&#39;);</span><br><span class="line">        &#125;)</span><br><span class="line">        $(&#39;.overlay&#39;).click(function() &#123;</span><br><span class="line">          $(&#39;.overlay&#39;).fadeOut(&#39;slow&#39;);</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;);</span><br><span class="line">    &lt;&#x2F;script&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">      .overlay &#123;</span><br><span class="line">        position: fixed;</span><br><span class="line">        top: 0;</span><br><span class="line">        left: 0;</span><br><span class="line">        width: 100%;</span><br><span class="line">        height: 100%;</span><br><span class="line">      &#125;</span><br><span class="line">      .overlay-background &#123;</span><br><span class="line">        background-color: #000;</span><br><span class="line">        filter:alpha(opacity&#x3D;80);</span><br><span class="line">        -moz-opacity: 0.8;</span><br><span class="line">        -khtml-opacity: 0.8;</span><br><span class="line">        opacity: 0.8;</span><br><span class="line">        z-index: 10000;</span><br><span class="line">      &#125;</span><br><span class="line">      .overlay-foreground &#123;</span><br><span class="line">        background-position: center center;</span><br><span class="line">        background-repeat: no-repeat;</span><br><span class="line">        z-index: 10001;</span><br><span class="line">      &#125;</span><br><span class="line">    &lt;&#x2F;style&gt;</span><br><span class="line">  &lt;&#x2F;head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;div role&#x3D;&quot;main&quot;&gt;</span><br><span class="line">      &lt;h1&gt;</span><br><span class="line">        Image gallery mixed content!</span><br><span class="line">      &lt;&#x2F;h1&gt;</span><br><span class="line">      &lt;p&gt;</span><br><span class="line">        View page over: &lt;a href&#x3D;&quot;http:&#x2F;&#x2F;googlesamples.github.io&#x2F;web-fundamentals&#x2F;fundamentals&#x2F;security&#x2F;prevent-mixed-content&#x2F;image-gallery-example.html&quot;&gt;HTTP&lt;&#x2F;a&gt; - &lt;a href&#x3D;&quot;https:&#x2F;&#x2F;googlesamples.github.io&#x2F;web-fundamentals&#x2F;fundamentals&#x2F;security&#x2F;prevent-mixed-content&#x2F;image-gallery-example.html&quot;&gt;HTTPS&lt;&#x2F;a&gt;</span><br><span class="line">      &lt;&#x2F;p&gt;</span><br><span class="line">      &lt;p&gt;</span><br><span class="line">        Image galleries often rely on the &lt;img&gt; tag src attribute to display thumbnail images on the page, the anchor ( &lt;a&gt; ) tag href attribute is then used to load the full sized image for the gallery overlay. Normally &lt;a&gt; tags do not cause mixed content, but in this case the jQuery code overrides the default link behavior &amp;mdash; to navigate to a new page &amp;mdash; and instead loads the HTTP image on this page. While this content isn&#39;t blocked, modern browsers display a warning in the JavaScript console. This can be seen when the page is viewed over HTTPS and the thumbnail is clicked.</span><br><span class="line">      &lt;&#x2F;p&gt;</span><br><span class="line">      CLICK ME! --&gt;</span><br><span class="line">      &lt;a class&#x3D;&quot;gallery&quot; href&#x3D;&quot;http:&#x2F;&#x2F;googlesamples.github.io&#x2F;web-fundamentals&#x2F;fundamentals&#x2F;security&#x2F;prevent-mixed-content&#x2F;puppy.jpg&quot;&gt;</span><br><span class="line">        &lt;img src&#x3D;&quot;https:&#x2F;&#x2F;googlesamples.github.io&#x2F;web-fundamentals&#x2F;fundamentals&#x2F;security&#x2F;prevent-mixed-content&#x2F;puppy-thumb.jpg&quot;&gt;</span><br><span class="line">      &lt;&#x2F;a&gt;</span><br><span class="line">      &lt;div class&#x3D;&quot;overlay overlay-background&quot; style&#x3D;&quot;display: none;&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">      &lt;div class&#x3D;&quot;overlay overlay-foreground&quot; style&#x3D;&quot;display: none;&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">  (function(b,o,i,l,e,r)&#123;b.GoogleAnalyticsObject&#x3D;l;b[l]||(b[l]&#x3D;</span><br><span class="line">  function()&#123;(b[l].q&#x3D;b[l].q||[]).push(arguments)&#125;);b[l].l&#x3D;+new Date;</span><br><span class="line">  e&#x3D;o.createElement(i);r&#x3D;o.getElementsByTagName(i)[0];</span><br><span class="line">  e.src&#x3D;&#39;&#x2F;&#x2F;www.google-analytics.com&#x2F;analytics.js&#39;;</span><br><span class="line">  r.parentNode.insertBefore(e,r)&#125;(window,document,&#39;script&#39;,&#39;ga&#39;));</span><br><span class="line">  ga(&#39;create&#39;,&#39;UA-52746336-1&#39;);ga(&#39;send&#39;,&#39;pageview&#39;);</span><br><span class="line">  var isCompleted &#x3D; &#123;&#125;;</span><br><span class="line">  function sampleCompleted(sampleName)&#123;</span><br><span class="line">    if (ga &amp;&amp; !isCompleted.hasOwnProperty(sampleName)) &#123;</span><br><span class="line">      ga(&#39;send&#39;, &#39;event&#39;, &#39;WebCentralSample&#39;, sampleName, &#39;completed&#39;);</span><br><span class="line">      isCompleted[sampleName] &#x3D; true;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line">  &lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://googlesamples.github.io/web-fundamentals/fundamentals/security/prevent-mixed-content/image-gallery-example.html">试一下</a></p>
<p>图像库通常依靠 <code>&lt;img&gt;</code> 标记 <code>src</code> 属性在页面上显示缩略图，然后，使用定位 (<code>&lt;a&gt;</code>) 标记 <code>href</code> 属性为图像库叠加层加载完整尺寸的图像。正常情况下，<code>&lt;a&gt;</code> 标记不会产生混合内容，但在此例中，jQuery 代码替换默认链接行为（导航到新页面），改为在此页面上加载 <strong>HTTP</strong> 图像。</p>
<p><img src="https://developers.google.com/web/fundamentals/security/prevent-mixed-content/imgs/image-gallery-warning.png?hl=zh-cn" alt="混合内容：页面已通过 HTTPS 加载，但请求了不安全的图像。此内容也应通过 HTTPS 提供。"></p>
<p>不安全的图像会降低网站的安全性，但是它们的危险性与其他类型的混合内容不一样。 现代浏览器仍会加载混合内容图像，但也会向用户显示警告。</p>
<h2 id="混合内容类型与相关安全威胁"><a href="#混合内容类型与相关安全威胁" class="headerlink" title="混合内容类型与相关安全威胁"></a>混合内容类型与相关安全威胁</h2><p>混合内容有两种：主动混合内容和被动混合内容</p>
<p><strong>被动混合内容</strong>指的是不与页面其余部分进行交互的内容，从而使中间人攻击在拦截或更改该内容时能够执行的操作受限。被动混合内容包括图像、视频和音频内容，以及无法与页面其余部分进行交互的其他资源。</p>
<p><strong>主动混合内容</strong>作为整体与页面进行交互，并且几乎允许攻击者对页面进行任何操作。 主动混合内容包括浏览器可下载和执行的脚本、样式表、iframe、flash 资源及其他代码。</p>
<h3 id="被动混合内容"><a href="#被动混合内容" class="headerlink" title="被动混合内容"></a>被动混合内容</h3><p>被动混合内容仍会给您的网站和用户带来安全威胁。 例如，攻击者可以拦截针对网站上的图像的 HTTP 请求，调换或更换这些图像；此攻击者可以调换“save and delete”按钮图像，导致您的用户无意间删除内容；将您的产品图表更换为下流或淫秽内容，从而损害您的网站；或将您的产品图像更换为不同网站或产品的广告。</p>
<p>即使攻击者不改变您的网站内容，您仍面临严重的隐私问题，攻击者可以使用混合内容请求跟踪用户。攻击者可以基于浏览器加载的图像或其他资源了解用户访问哪些页面，以及查看了哪些产品。</p>
<p>以下是被动混合内容的示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta charset&#x3D;&quot;utf-8&quot;&gt;</span><br><span class="line">    &lt;meta http-equiv&#x3D;&quot;X-UA-Compatible&quot; content&#x3D;&quot;IE&#x3D;edge&quot;&gt;</span><br><span class="line">    &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1&quot;&gt;</span><br><span class="line">    &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;https:&#x2F;&#x2F;fonts.googleapis.com&#x2F;icon?family&#x3D;Material+Icons&quot;&gt;</span><br><span class="line">    &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;https:&#x2F;&#x2F;code.getmdl.io&#x2F;1.2.1&#x2F;material.indigo-pink.min.css&quot;&gt;</span><br><span class="line">    &lt;script defer src&#x3D;&quot;https:&#x2F;&#x2F;code.getmdl.io&#x2F;1.2.1&#x2F;material.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">      body &#123;</span><br><span class="line">        margin: 2em;</span><br><span class="line">      &#125;</span><br><span class="line">    &lt;&#x2F;style&gt;</span><br><span class="line">    &lt;title&gt;Passive mixed content example&lt;&#x2F;title&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">      audio, img, video &#123;</span><br><span class="line">        display: block;</span><br><span class="line">        margin: 10px;</span><br><span class="line">      &#125;</span><br><span class="line">    &lt;&#x2F;style&gt;</span><br><span class="line">  &lt;&#x2F;head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;div role&#x3D;&quot;main&quot;&gt;</span><br><span class="line">      &lt;h1&gt;</span><br><span class="line">        Passive mixed content!</span><br><span class="line">      &lt;&#x2F;h1&gt;</span><br><span class="line">      &lt;p&gt;</span><br><span class="line">        View page over: &lt;a href&#x3D;&quot;http:&#x2F;&#x2F;googlesamples.github.io&#x2F;web-fundamentals&#x2F;fundamentals&#x2F;security&#x2F;prevent-mixed-content&#x2F;passive-mixed-content.html&quot;&gt;HTTP&lt;&#x2F;a&gt; - &lt;a href&#x3D;&quot;https:&#x2F;&#x2F;googlesamples.github.io&#x2F;web-fundamentals&#x2F;fundamentals&#x2F;security&#x2F;prevent-mixed-content&#x2F;passive-mixed-content.html&quot;&gt;HTTPS&lt;&#x2F;a&gt;</span><br><span class="line">      &lt;&#x2F;p&gt;</span><br><span class="line">      &lt;p&gt;</span><br><span class="line">        Several examples of passive mixed content. When viewed over HTTPS most browsers do &lt;b&gt;not&lt;&#x2F;b&gt; block this content but instead display warnings in the JavaScript console.</span><br><span class="line">      &lt;&#x2F;p&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- An insecure audio file loaded on a secure page --&gt;</span><br><span class="line">      &lt;audio src&#x3D;&quot;http:&#x2F;&#x2F;googlesamples.github.io&#x2F;web-fundamentals&#x2F;fundamentals&#x2F;security&#x2F;prevent-mixed-content&#x2F;sleep.mp3&quot; type&#x3D;&quot;audio&#x2F;mp3&quot; controls&gt;&lt;&#x2F;audio&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- An insecure image loaded on a secure page --&gt;</span><br><span class="line">      &lt;img src&#x3D;&quot;http:&#x2F;&#x2F;googlesamples.github.io&#x2F;web-fundamentals&#x2F;fundamentals&#x2F;security&#x2F;prevent-mixed-content&#x2F;puppy.jpg&quot;&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- An insecure video file loaded on a secure page --&gt;</span><br><span class="line">      &lt;video src&#x3D;&quot;http:&#x2F;&#x2F;storage.googleapis.com&#x2F;webfundamentals-assets&#x2F;videos&#x2F;chrome.webm&quot; type&#x3D;&quot;video&#x2F;webm&quot; controls&gt;&lt;&#x2F;video&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">  (function(b,o,i,l,e,r)&#123;b.GoogleAnalyticsObject&#x3D;l;b[l]||(b[l]&#x3D;</span><br><span class="line">  function()&#123;(b[l].q&#x3D;b[l].q||[]).push(arguments)&#125;);b[l].l&#x3D;+new Date;</span><br><span class="line">  e&#x3D;o.createElement(i);r&#x3D;o.getElementsByTagName(i)[0];</span><br><span class="line">  e.src&#x3D;&#39;&#x2F;&#x2F;www.google-analytics.com&#x2F;analytics.js&#39;;</span><br><span class="line">  r.parentNode.insertBefore(e,r)&#125;(window,document,&#39;script&#39;,&#39;ga&#39;));</span><br><span class="line">  ga(&#39;create&#39;,&#39;UA-52746336-1&#39;);ga(&#39;send&#39;,&#39;pageview&#39;);</span><br><span class="line">  var isCompleted &#x3D; &#123;&#125;;</span><br><span class="line">  function sampleCompleted(sampleName)&#123;</span><br><span class="line">    if (ga &amp;&amp; !isCompleted.hasOwnProperty(sampleName)) &#123;</span><br><span class="line">      ga(&#39;send&#39;, &#39;event&#39;, &#39;WebCentralSample&#39;, sampleName, &#39;completed&#39;);</span><br><span class="line">      isCompleted[sampleName] &#x3D; true;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line">  &lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://googlesamples.github.io/web-fundamentals/fundamentals/security/prevent-mixed-content/passive-mixed-content.html">试一下</a></p>
<p>大多数浏览器仍向用户渲染此类型的混合内容，但是也会显示警告，因为这些内容会给您的网站和用户带来安全风险和隐私风险。</p>
<p><img src="https://developers.google.com/web/fundamentals/security/prevent-mixed-content/imgs/passive-mixed-content-warnings.png?hl=zh-cn" alt="混合内容：页面已通过 HTTPS 加载，但请求了不安全的视频。此内容也应通过 HTTPS 提供。">来自 Chrome JavaScript 控制台的混合内容警告。</p>
<h3 id="主动混合内容"><a href="#主动混合内容" class="headerlink" title="主动混合内容"></a>主动混合内容</h3><p>与被动混合内容相比，主动混合内容造成的威胁更大。攻击者可以拦截和重写主动内容，从而完全控制页面，甚至整个网站。这让攻击者可以更改有关页面的任何内容，包括显示完全不同的内容、窃取用户密码或其他登录凭据、窃取用户会话 Cookie，或将用户重定向到一个完全不同的网站。</p>
<p>鉴于这种威胁的严重性，许多浏览器都会默认阻止此类型的内容以保护用户，但是其作用因浏览器供应商和版本而有所差异。</p>
<p>以下包含主动混合内容的示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta charset&#x3D;&quot;utf-8&quot;&gt;</span><br><span class="line">    &lt;meta http-equiv&#x3D;&quot;X-UA-Compatible&quot; content&#x3D;&quot;IE&#x3D;edge&quot;&gt;</span><br><span class="line">    &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1&quot;&gt;</span><br><span class="line">    &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;https:&#x2F;&#x2F;fonts.googleapis.com&#x2F;icon?family&#x3D;Material+Icons&quot;&gt;</span><br><span class="line">    &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;https:&#x2F;&#x2F;code.getmdl.io&#x2F;1.2.1&#x2F;material.indigo-pink.min.css&quot;&gt;</span><br><span class="line">    &lt;script defer src&#x3D;&quot;https:&#x2F;&#x2F;code.getmdl.io&#x2F;1.2.1&#x2F;material.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">      body &#123;</span><br><span class="line">        margin: 2em;</span><br><span class="line">      &#125;</span><br><span class="line">    &lt;&#x2F;style&gt;</span><br><span class="line">    &lt;title&gt;Active mixed content example&lt;&#x2F;title&gt;</span><br><span class="line">    &lt;!-- An insecure script file loaded on a secure page --&gt;</span><br><span class="line">    &lt;script src&#x3D;&quot;http:&#x2F;&#x2F;googlesamples.github.io&#x2F;web-fundamentals&#x2F;fundamentals&#x2F;security&#x2F;prevent-mixed-content&#x2F;simple-example.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- An insecure stylesheet loaded on a secure page --&gt;</span><br><span class="line">    &lt;link href&#x3D;&quot;http:&#x2F;&#x2F;googlesamples.github.io&#x2F;web-fundamentals&#x2F;fundamentals&#x2F;security&#x2F;prevent-mixed-content&#x2F;style.css&quot; rel&#x3D;&quot;stylesheet&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;style&gt;</span><br><span class="line">      .insecure-background &#123;</span><br><span class="line">        &#x2F;* An insecure resources loaded from a style property on a secure page, this can</span><br><span class="line">           happen in many places including, @font-face, cursor, background-image, and so on. *&#x2F;</span><br><span class="line">        background: url(&#39;http:&#x2F;&#x2F;googlesamples.github.io&#x2F;web-fundamentals&#x2F;fundamentals&#x2F;security&#x2F;prevent-mixed-content&#x2F;puppy-thumb.jpg&#39;) no-repeat;</span><br><span class="line">      &#125;</span><br><span class="line">    &lt;&#x2F;style&gt;</span><br><span class="line"></span><br><span class="line">    &lt;style&gt;</span><br><span class="line">      .insecure-style-holder span &#123;</span><br><span class="line">        color: #fff;</span><br><span class="line">      &#125;</span><br><span class="line">      .insecure-background &#123;</span><br><span class="line">        color: #000;</span><br><span class="line">        font-weight: bold;</span><br><span class="line">        background-position: left center;</span><br><span class="line">        background-repeat: no-repeat;</span><br><span class="line">        width: 300px;</span><br><span class="line">        height: 140px;</span><br><span class="line">      &#125;</span><br><span class="line">      iframe &#123;</span><br><span class="line">        width: 400px;</span><br><span class="line">        height: 300px;</span><br><span class="line">      &#125;</span><br><span class="line">    &lt;&#x2F;style&gt;</span><br><span class="line"></span><br><span class="line">  &lt;&#x2F;head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;div role&#x3D;&quot;main&quot;&gt;</span><br><span class="line">      &lt;h1&gt;</span><br><span class="line">        Active mixed content!</span><br><span class="line">      &lt;&#x2F;h1&gt;</span><br><span class="line">      &lt;p&gt;</span><br><span class="line">        View page over: &lt;a href&#x3D;&quot;http:&#x2F;&#x2F;googlesamples.github.io&#x2F;web-fundamentals&#x2F;fundamentals&#x2F;security&#x2F;prevent-mixed-content&#x2F;active-mixed-content.html&quot;&gt;HTTP&lt;&#x2F;a&gt; - &lt;a href&#x3D;&quot;https:&#x2F;&#x2F;googlesamples.github.io&#x2F;web-fundamentals&#x2F;fundamentals&#x2F;security&#x2F;prevent-mixed-content&#x2F;active-mixed-content.html&quot;&gt;HTTPS&lt;&#x2F;a&gt;</span><br><span class="line">      &lt;&#x2F;p&gt;</span><br><span class="line">      &lt;p&gt;</span><br><span class="line">        Several examples of active mixed content. When viewed over HTTPS most browsers block this content and display errors in the JavaScript console.</span><br><span class="line">      &lt;&#x2F;p&gt;</span><br><span class="line">      &lt;div class&#x3D;&quot;insecure-style-holder&quot;&gt;</span><br><span class="line">        &lt;span style&#x3D;&quot;ba&quot;&gt;Insecure style loaded&lt;&#x2F;span&gt;</span><br><span class="line">      &lt;&#x2F;div&gt;</span><br><span class="line">      &lt;div class&#x3D;&quot;insecure-background&quot;&gt;</span><br><span class="line">        Loading insecure background here...</span><br><span class="line">      &lt;&#x2F;div&gt;</span><br><span class="line"></span><br><span class="line">      &lt;p&gt;Loading insecure iframe...&lt;&#x2F;p&gt;</span><br><span class="line">      &lt;!-- An insecure iframed page loaded on a secure page --&gt;</span><br><span class="line">      &lt;iframe src&#x3D;&quot;http:&#x2F;&#x2F;googlesamples.github.io&#x2F;web-fundamentals&#x2F;fundamentals&#x2F;security&#x2F;prevent-mixed-content&#x2F;image-gallery-example.html&quot;&gt;&lt;&#x2F;iframe&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- Flash resources also qualify as active mixed content and pose a</span><br><span class="line">      serious security risk. Be sure to look for &lt;object&gt; tags with type set</span><br><span class="line">      to &quot;application&#x2F;x-shockwave-flash&quot;, and an http:&#x2F;&#x2F; data attribute. --&gt;</span><br><span class="line">      &lt;!-- &lt;object type&#x3D;&quot;application&#x2F;x-shockwave-flash&quot; data&#x3D;&quot;http:&#x2F;&#x2F;...&quot;&gt;&lt;&#x2F;object&gt; --&gt;</span><br><span class="line"></span><br><span class="line">      &lt;script&gt;</span><br><span class="line">        &#x2F;&#x2F; An insecure resource loaded using XMLHttpRequest</span><br><span class="line">        var request &#x3D; new XMLHttpRequest();</span><br><span class="line">        request.addEventListener(&#39;load&#39;, function() &#123;</span><br><span class="line">          var jsonData &#x3D; JSON.parse(request.responseText);</span><br><span class="line">          document.getElementById(&#39;output&#39;).innerHTML +&#x3D; &#39;&lt;br&gt;&#39; + jsonData.data;</span><br><span class="line">        &#125;);</span><br><span class="line">        request.open(&quot;GET&quot;, &quot;http:&#x2F;&#x2F;googlesamples.github.io&#x2F;web-fundamentals&#x2F;fundamentals&#x2F;security&#x2F;prevent-mixed-content&#x2F;xmlhttprequest-data.js&quot;, true);</span><br><span class="line">        request.send();</span><br><span class="line">      &lt;&#x2F;script&gt;</span><br><span class="line">      &lt;div id&#x3D;&quot;output&quot;&gt;Waiting for insecure script to run...&lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">  (function(b,o,i,l,e,r)&#123;b.GoogleAnalyticsObject&#x3D;l;b[l]||(b[l]&#x3D;</span><br><span class="line">  function()&#123;(b[l].q&#x3D;b[l].q||[]).push(arguments)&#125;);b[l].l&#x3D;+new Date;</span><br><span class="line">  e&#x3D;o.createElement(i);r&#x3D;o.getElementsByTagName(i)[0];</span><br><span class="line">  e.src&#x3D;&#39;&#x2F;&#x2F;www.google-analytics.com&#x2F;analytics.js&#39;;</span><br><span class="line">  r.parentNode.insertBefore(e,r)&#125;(window,document,&#39;script&#39;,&#39;ga&#39;));</span><br><span class="line">  ga(&#39;create&#39;,&#39;UA-52746336-1&#39;);ga(&#39;send&#39;,&#39;pageview&#39;);</span><br><span class="line">  var isCompleted &#x3D; &#123;&#125;;</span><br><span class="line">  function sampleCompleted(sampleName)&#123;</span><br><span class="line">    if (ga &amp;&amp; !isCompleted.hasOwnProperty(sampleName)) &#123;</span><br><span class="line">      ga(&#39;send&#39;, &#39;event&#39;, &#39;WebCentralSample&#39;, sampleName, &#39;completed&#39;);</span><br><span class="line">      isCompleted[sampleName] &#x3D; true;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line">  &lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://googlesamples.github.io/web-fundamentals/fundamentals/security/prevent-mixed-content/active-mixed-content.html">试一下</a></p>
<p><img src="https://developers.google.com/web/fundamentals/security/prevent-mixed-content/imgs/active-mixed-content-errors.png?hl=zh-cn" alt="混合内容：页面已通过 HTTPS 加载，但请求了不安全的资源。此请求已被阻止，内容必须通过 HTTPS 提供。">来自 Chrome JavaScript 控制台的混合内容错误。</p>
<h2 id="具有混合内容的浏览器行为"><a href="#具有混合内容的浏览器行为" class="headerlink" title="具有混合内容的浏览器行为"></a>具有混合内容的浏览器行为</h2><p>鉴于上述威胁，浏览器最好是阻止所有混合内容。 但是，这将破坏大量网站，而数百万用户每天都要访问这些网站。 当前的折衷做法是阻止最危险的混合内容类型，同时仍允许请求不太危险的混合内容类型。</p>
<p>现代浏览器遵循<a target="_blank" rel="noopener external nofollow noreferrer" href="https://w3c.github.io/webappsec/specs/mixedcontent/">混合内容规范</a>，其定义了<a target="_blank" rel="noopener external nofollow noreferrer" href="https://w3c.github.io/webappsec/specs/mixedcontent/#category-optionally-blockable"><strong>可选择性地阻止的内容</strong></a>和<a target="_blank" rel="noopener external nofollow noreferrer" href="https://w3c.github.io/webappsec/specs/mixedcontent/#category-blockable"><strong>可阻止的内容</strong></a>类别。</p>
<p>根据此规范，“当破坏网络重要部分的风险超过允许此资源作为混合内容使用的风险时”，该资源有资格成为可选择性阻止的内容；这是上述<a target="_blank" rel="noopener external nofollow noreferrer" href="https://developers.google.com/web/fundamentals/security/prevent-mixed-content/what-is-mixed-content?hl=zh-cn#passive-mixed-content">被动混合内容</a>类别的子集。在撰写本文时，可选择性阻止的内容中仅包括图像、视频和音频资源以及预获取的链接这些资源类型。随着时间的推移，此类别可能会缩小。</p>
<p><strong>可选择性阻止的内容</strong>以外的所有内容被视为<strong>可阻止的内容</strong>，将被浏览器阻止。</p>
<h3 id="浏览器版本"><a href="#浏览器版本" class="headerlink" title="浏览器版本"></a>浏览器版本</h3><p>切记，并不是网站的每个访问者都使用最新的浏览器。 不同浏览器供应商的不同版本的浏览器处理混合内容的方式不尽相同。 最糟糕的情况是，有些浏览器和版本根本不会阻止任何混合内容，这对于用户而言非常不安全。</p>
<p>每个浏览器的确切行为不断变化，因此，我们在这里不做具体介绍。 如果您对特定浏览器的行为方式感兴趣，请直接查看供应商发布的信息。</p>
<h3 id="缺少中间根证书"><a href="#缺少中间根证书" class="headerlink" title="缺少中间根证书"></a>缺少中间根证书</h3><p>还有一种情况是由于证书链不完整缺少中间根证书导致的。这个情况下<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.bisend.cn/blog/ruhezhaodaosslzhengshudezhongjiangenzhengshu">找到SSL证书的中间根证书</a>、补全证书链再重新安装即可解决问题。</p>
<p>以上即为几种常见的导致SSL证书部署后仍出现不安全提示的原因。如果一一排查之后还是不能解决问题，或者处理过程中不知该如何操作，可提交工单或在线联系必盛云客服为您处理。</p>
<h3 id="相关文章："><a href="#相关文章：" class="headerlink" title="相关文章："></a>相关文章：</h3><ul>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.bisend.cn/blog/comodozhengshuhebingjizhuanhuanjiaocheng">Comodo证书合并及转换教程</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.bisend.cn/blog/digicertzhengshuhebingjizhuanhuanjiaocheng">Digicert、Symantec和Geotrust证书合并及转换教程</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.bisend.cn/blog/shenqingsslzhengshuzenyangzuoyumingyanzheng">申请SSL证书怎样做域名验证</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.bisend.cn/blog/ru-he-shen-qing-ov-ev-ssl-zheng-shu">如何申请OV/EV SSL 证书</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.bisend.cn/blog/ruhebushusslzhengshu">如何部署SSL证书</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.bisend.cn/blog/apachefuwuqianzhuangsslzhengshu">Apache服务器安装SSL证书</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.bisend.cn/blog/ruhebeifenhuodaochusslzhengshu">如何备份或导出SSL证书</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.bisend.cn/blog/ip-ssl-certificates">IP地址可以安装SSL证书吗？</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://developers.google.com/web/fundamentals/security/prevent-mixed-content/what-is-mixed-content?hl=zh-cn">混合内容</a></li>
</ul>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined" rel="external nofollow noreferrer">MysticalYcc</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://gschaos.club/%E4%B8%BA%E4%BB%80%E4%B9%88%E9%83%A8%E7%BD%B2SSL%E8%AF%81%E4%B9%A6%E5%90%8E%EF%BC%8C%E8%BF%98%E6%98%AF%E6%8F%90%E7%A4%BA%E4%B8%8D%E5%AE%89%E5%85%A8/">https://gschaos.club/%E4%B8%BA%E4%BB%80%E4%B9%88%E9%83%A8%E7%BD%B2SSL%E8%AF%81%E4%B9%A6%E5%90%8E%EF%BC%8C%E8%BF%98%E6%98%AF%E6%8F%90%E7%A4%BA%E4%B8%8D%E5%AE%89%E5%85%A8/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://gschaos.club" target="_blank">MysticalYcc</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/">服务器</a><a class="post-meta__tags" href="/tags/ssl/">ssl</a><a class="post-meta__tags" href="/tags/%E7%BD%91%E7%AB%99/">网站</a><a class="post-meta__tags" href="/tags/https/">https</a></div><div class="post_share"><div class="social-share" data-image="https://mysticalyu.gitee.io/pic/img/aniraiden-wu-final003-00000.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/%E6%9F%94%E6%80%A7%E5%A4%9A%E6%80%81/"><img class="prev-cover" src="https://mysticalyu.gitee.io/pic/img/go-wah-e-wechat-image-20200325132508.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">柔性多态</div></div></a></div><div class="next-post pull-right"><a href="/Nginx%20%E9%85%8D%E7%BD%AE/"><img class="next-cover" src="https://mysticalyu.gitee.io/pic/img/yun-sihang-yun-sh-eee.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Nginx 配置</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/Linux设置虚拟内存/" title="Linux设置虚拟内存"><img class="cover" src="https://mysticalyu.gitee.io/pic/img/20200605013054948.jpg"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2020-09-27</div><div class="title">Linux设置虚拟内存</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></article></main><footer id="footer" style="background-image: url(https://mysticalyu.gitee.io/pic/img/aniraiden-wu-final003-00000.jpg)"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By MysticalYcc</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="icp"><a target="_blank" rel="noopener external nofollow noreferrer" href="http://www.beian.miit.gov.cn/state/outPortal/loginPortal.action"><img class="icp-icon" src="/img/icp.png"/><span>皖ICP备19015872号-1</span></a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> {preloader.endLoading()})</script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const initData = {
      el: '#vcomment',
      appId: 'J2f6Gx43ptrGYdf1rHPAS5sJ-gzGzoHsz',
      appKey: 'cSywIQR7CfBFaNI8iiPTYy41',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'en',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
    }

    if (true) { 
      initData.requiredFields= ('nick,mail'.split(','))
    }

    const valine = new Valine(initData)
  }

  if (typeof Valine === 'function') initValine() 
  else $.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.querySelector('#vcomment'),loadValine)
  else setTimeout(() => loadValine(), 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.17.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<[^>]+>/g,"") // remove html tag
    content = content.replace(/(http(s?):)([/|.|\w|\s|-])*\.(?:jpg|jpeg|gif|png|webp)/g, '') // remove image link
    content = content.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi, '') // remove url

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getIcon = (icon, mail) => {
    if (icon) return icon 
    let defaultIcon = ''
    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`
    return iconUrl
  }

  const generateHtml = array => {
    let result = ''

    for (let i = 0; i < array.length; i++) {
      result += '<div class=\'aside-list-item\'>'

      if (true) {
        result += `<a href='${array[i].url}' class="thumbnail"><img src='${getIcon(array[i].avatar, array[i].mail)}' alt='${array[i].nick}'></a>`
      }

      result += `<div class='content'>
      <a class='comment' href='${array[i].url}'>${array[i].content}</a>
      <div class='name'><span>${array[i].nick}</span><time> / ${btf.diffDate(array[i].date, true)}</time></div>
      </div></div>`
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.pjax && window.pjax.refresh($dom)
  }

  const getValineData = () => {
      let serverURL = ''
      if (true) {
        serverURL = 'https://j2f6gx43.lc-cn-n1-shared.com'
      } else {
        serverURL = 'https://J2f6Gx43.api.lncldglobal.com'
      }

    var settings = {
      "url": `${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,
      "method": "GET",
      "timeout": 0,
      "headers": {
        "X-LC-Id": 'J2f6Gx43ptrGYdf1rHPAS5sJ-gzGzoHsz',
        "X-LC-Key": 'cSywIQR7CfBFaNI8iiPTYy41',
        "Content-Type": "application/json"
      },
    }

    $.ajax(settings).done((response) => {
      var valineArray = []
      response.results.forEach((e)=>{
        valineArray.push({
          'avatar': e.QQAvatar,
          'content': changeContent(e.comment),
          'mail': e.mail,
          'nick': e.nick,
          'url': e.url,
          'date': e.createdAt,
        })
      })
      
      saveToLocal.set('leancloud-newest-comments', JSON.stringify(valineArray), 10/(60*24))
      generateHtml(valineArray)

    }).fail(()=>{
      const $dom = document.querySelector('#card-newest-comments .aside-list')
      $dom.innerHTML= "无法获取资料，请确认相关配置是否正确"
    })
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('leancloud-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getValineData()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><div class="aplayer no-destroy" data-id="2920702828" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="true" muted></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  'meta[name=description]',
  '#config_change',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  $('script[data-pjax]').each(function () {
    $(this).parent().append($(this).remove())
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  if (typeof gtag === 'function') {
    gtag('config', '', {'page_path': window.location.pathname});
  }

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})


document.addEventListener('pjax:send', function () {
  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  $(window).off('scroll')

  //reset readmode
  $('body').hasClass('read-mode') && $('body').removeClass('read-mode')

})</script></div></body></html>