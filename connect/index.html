<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>浏览器 | MysticalYcc</title><meta name="keywords" content="计算机网络"><meta name="author" content="MysticalYcc"><meta name="copyright" content="MysticalYcc"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="从输入一个地址开始，它可以是这样的  www.baidu.com, 也可以是这样的 https:&#x2F;&#x2F;admin:admin@www.gschaos.club:80&#x2F;dir&#x2F;file1.html, 咋一看好像都能看懂,而且还知道这么输入会得到什么,更言之还能断点调试一下; 可是输入一个网址到底发生了什么？">
<meta property="og:type" content="article">
<meta property="og:title" content="浏览器">
<meta property="og:url" content="https://gschaos.club/connect/index.html">
<meta property="og:site_name" content="MysticalYcc">
<meta property="og:description" content="从输入一个地址开始，它可以是这样的  www.baidu.com, 也可以是这样的 https:&#x2F;&#x2F;admin:admin@www.gschaos.club:80&#x2F;dir&#x2F;file1.html, 咋一看好像都能看懂,而且还知道这么输入会得到什么,更言之还能断点调试一下; 可是输入一个网址到底发生了什么？">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://mysticalyu.gitee.io/pic/img/20200407233909-www-ycfcg-com-2(4).jpg">
<meta property="article:published_time" content="2020-01-10T16:00:00.000Z">
<meta property="article:modified_time" content="2020-09-15T09:52:30.000Z">
<meta property="article:author" content="MysticalYcc">
<meta property="article:tag" content="计算机网络">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://mysticalyu.gitee.io/pic/img/20200407233909-www-ycfcg-com-2(4).jpg"><link rel="shortcut icon" href="/ico/favicon.ico"><link rel="canonical" href="https://gschaos.club/connect/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  hexoversion: '5.1.1',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true,
  postUpdate: '2020-09-15 17:52:30'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
  }
}

var autoChangeMode = 'false'
var t = saveToLocal.get('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (saveToLocal.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><meta name="generator" content="Hexo 5.1.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://gschaos.club/ico/me.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">45</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">29</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">16</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-camera-retro"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><span> 画廊</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8"><span class="toc-number">1.</span> <span class="toc-text">浏览器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#URL"><span class="toc-number">1.1.</span> <span class="toc-text">URL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E8%A7%A3%E6%9E%90URL"><span class="toc-number">1.2.</span> <span class="toc-text">浏览器解析URL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.3.</span> <span class="toc-text">HTTP协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IP%E5%9C%B0%E5%9D%80"><span class="toc-number">1.4.</span> <span class="toc-text">IP地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DNS"><span class="toc-number">1.5.</span> <span class="toc-text">DNS</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-TCP-IP%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B%E5%8F%8A%E5%8D%8F%E8%AE%AE"><span class="toc-number">2.</span> <span class="toc-text">2 TCP&#x2F;IP参考模型及协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%A8%A1%E5%9E%8B"><span class="toc-number">3.</span> <span class="toc-text">1) 模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%8D%8F%E8%AE%AE"><span class="toc-number">4.</span> <span class="toc-text">2) 协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E7%89%A9%E7%90%86%E5%B1%82"><span class="toc-number">5.</span> <span class="toc-text">3 物理层</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82"><span class="toc-number">6.</span> <span class="toc-text">4 数据链路层</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E7%BD%91%E7%BB%9C%E5%B1%82"><span class="toc-number">7.</span> <span class="toc-text">5 网络层</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IP%E5%A4%B4"><span class="toc-number">8.</span> <span class="toc-text">IP头</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E4%BC%A0%E8%BE%93%E5%B1%82"><span class="toc-number">9.</span> <span class="toc-text">6 传输层</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-TCP%E7%9A%84%E5%8A%9F%E8%83%BD"><span class="toc-number">10.</span> <span class="toc-text">1) TCP的功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-TCP%E5%A4%B4%E7%9A%84%E4%BB%8B%E7%BB%8D"><span class="toc-number">11.</span> <span class="toc-text">2) TCP头的介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E4%BC%A0%E8%AF%B4%E4%B8%AD%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B%EF%BC%88%E6%8A%93%E5%8C%85%E6%BC%94%E7%A4%BA%EF%BC%89"><span class="toc-number">12.</span> <span class="toc-text">3) 传说中的三次握手和四次挥手（抓包演示）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E5%BA%94%E7%94%A8%E5%B1%82"><span class="toc-number">13.</span> <span class="toc-text">7 应用层</span></a></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(https://mysticalyu.gitee.io/pic/img/20200407233909-www-ycfcg-com-2(4).jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">MysticalYcc</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-camera-retro"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><span> 画廊</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">浏览器</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-01-10T16:00:00.000Z" title="发表于 2020-01-11 00:00:00">2020-01-11</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2020-09-15T09:52:30.000Z" title="更新于 2020-09-15 17:52:30">2020-09-15</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E4%B9%88%E8%BF%9E%E6%8E%A5%E7%9A%84/">网络是怎么连接的</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><p><img src="https://mysticalyu.gitee.io/pic/img/20200407233909-www-ycfcg-com-2(4).jpg"></p>
<p>   从输入一个地址开始，它可以是这样的 <font color=#2cede4> <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a></font>, 也可以是这样的 <strong><a target="_blank" rel="noopener" href="https://admin:admin@www.gschaos.club:80/dir/file1.html">https://admin:admin@www.gschaos.club:80/dir/file1.html</a></strong>, 咋一看好像都能看懂,而且还知道这么输入会得到什么,更言之还能断点调试一下; 可是输入一个网址到底发生了什么？</p>
 <a id="more"></a>




<h2 id="浏览器"><a href="#浏览器" class="headerlink" title="浏览器"></a><font color=#2cede4>浏览器</font></h2><p>   从输入一个地址开始，它可以是这样的 <font color=#2cede4> <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a></font>, 也可以是这样的 <strong><a target="_blank" rel="noopener" href="https://admin:admin@www.gschaos.club:80/dir/file1.html">https://admin:admin@www.gschaos.club:80/dir/file1.html</a></strong>, 咋一看好像都能看懂,而且还知道这么输入会得到什么,更言之还能断点调试一下;</p>
<h3 id="URL"><a href="#URL" class="headerlink" title="URL"></a><font color=#2cede4>URL</font></h3><p>我们先来看下URL,URL有很多种,不止我们常用到的http://,还有很多比如<font color=#2cede4>“file:” (读取本地文件) , “ftp:”(文件传输协议) , “mailto:”(邮件服务,需要配置正确的电子邮箱)</font>等.</p>
<p><img src="https://gitee.com/MysticalYu/pic/raw/master/hexo/url.png" alt="url的各种格式"></p>
<p>它们拥有同样的格式,即都需要定义一个访问方法(协议http,ftp等).</p>
<p><font color= \#E6E6FA >那么知道这些后浏览器做了什么呢?</font></p>
<h3 id="浏览器解析URL"><a href="#浏览器解析URL" class="headerlink" title="浏览器解析URL"></a><font color=#2cede4>浏览器解析URL</font></h3><p>浏览器首先对URL进行解析,从而生成发送给服务器的请求信息.依据不同的协议访问不同的服务器,这里阐述访问Web服务器的情况.</p>
<p>解析方式如下:</p>
<p><img src="https://gitee.com/MysticalYu/pic/raw/master/hexo/urlany.png" alt="URL解析"></p>
<p>有时候进入主页的时候文件名经常不写比如<strong><a target="_blank" rel="noopener" href="http://www.lab.com/dir/">http://www.lab.com/dir/</a></strong>,那么解析的时候就会去寻找目录下面的default.html或者index.html具体访问什么要看服务器如何配置.当不写最后一个**/**时,是会先寻找文件夹,再寻找文件名的规则来进行的.</p>
<p>明白了URL，我们来对URL中HTTP进行简单的说明。</p>
<h3 id="HTTP协议"><a href="#HTTP协议" class="headerlink" title="HTTP协议"></a><font color=#2cede4>HTTP协议</font></h3><p>HTTP协议定义了客户端和服务器之间交互的消息内容和步骤,请求中包含了<strong>对什么</strong>和<strong>做什么</strong>两个部分;</p>
<blockquote>
<p><strong>对什么</strong>: 这部分就是URI(统一资源标识符),一般来说,URI的内容是一个存放网页数据的文件名或者是一个CGI程序的文件名.例如/dir/file1.html;不过,URI不仅限于此,也可以直接用”http:”开头的URL来作为URI.换句话就是,这里可以写各种访问目标,而这些访问目标统称为URI.</p>
<p><strong>做什么</strong>:  也称为方法.表示需要Web服务器做什么,典型的例子包括读取URI表示的数据/将客户端输入的数据发送给URI表示的程序等.</p>
</blockquote>
<p><img src="https://gitee.com/MysticalYu/pic/raw/master/hexo/dowhat.png" alt="doWhat"></p>
<p>看到这张图是不是就对之前所解释的<strong>做什么</strong>有所了解了呢!</p>
<p>收到消息之后,Web服务器会对其中的内容进行解析,通过URI和方法来判断<font color=#2cede4>“对什么”,”做什么”</font>,并根据这些要求完成工作将结果放入响应消息中.</p>
<p>至此我们了解了HTTP的全貌,之后会一步步往下深入网络到底是怎么连接的..</p>
<p>当我们想寄一封信件的时候，我们需要能够帮助我们送信的机构，如果要自己送去那还送信做什么，直接过去把寄信人打一顿就完事了；所以就有了邮局(快递的你先放下…)，每个人都可以将信委托给邮局，让邮局帮我们将信件寄出去。我们发送一个网络请求也是，每个应用都可以发送网络请求，同样需要一个能够将消息发送到<strong>网络</strong>的机构，这个机构由操作系统来完成组建。所以，浏览器解析URL生成HTTP请求后需要委托操作系统将这些消息发送到网络。</p>
<p>当然，邮局也会要求我们填写一个寄信单，这个单子包括了<strong>寄信人的地址</strong>，<strong>寄信人的联系方式</strong>，<strong>收信人的地址</strong>，<strong>收信人的联系方式</strong>4个重要的信息(还有其他附加信息),填写正确才能将信件成功寄出。操作系统发送消息也是如此，它需要的是<strong>收信人的地址【对方的IP地址】，收信人的联系方式【对方的端口号】</strong>。发送方的自然也需要，只是两者绑定在一起，开机的那一刻就已经存在内存中了。</p>
<p>在这之前，来了解一下IP地址是啥子。</p>
<h3 id="IP地址"><a href="#IP地址" class="headerlink" title="IP地址"></a>IP地址</h3><p>住在有门牌号的房子的大伙都知道(如果没有，请默哀两分钟！)，寄发信件的时候需要填写自己和对方的具体地址，而这个地址就是小区的某个房间的门牌号，完整的地址包括了国家，省份市直辖区，县/区，乡镇小区等等。国家与国家之间形成了不同的区域，说中国在哪，一定会有答案，再往下，省市区小区直到门牌号，它就像一个唯一的号牌将这个地址标记出来。</p>
<p>IP地址同样是这样的道理。</p>
<p><img src="https://gitee.com/MysticalYu/pic/raw/master/hexo/intnet.png" alt="intnet"></p>
<p>互联网和公司内部的局域网都是基于TCP/IP的思路来设计的，如上图，就是由一些小的子网(小区甚至楼层之间)，通过路由器连接起来。这里的子网可以理解成为用集线器连接起来的几台计算机，将它看作一个单位，称为子网。将子网连接起来，就形成了一个网络。</p>
<p>你要说怎么理解，那看下面这张图吧(自己画的可能不准确！)。</p>
<p><img src="https://gitee.com/MysticalYu/pic/raw/master/hexo/naphthalene.png" alt="naphthalene"></p>
<p>在网络中所有的设备都会被分配一个地址。就好像是<strong>XX号XX室</strong>。其中<strong>号</strong>对应的号码是分配给整个子网的，而<strong>室</strong>对应的号码是分配给子网中的计算机的，这就是网络中的地址。<strong>号</strong>对应的号码称为网络号，<strong>室</strong>对应的号码称为主机号，这个地址的整体称为IP地址。发送者发送的消息首先经过子网中的集线器，转发到距离最近的路由器上。接下来，路由器会根据消息的目的地判断下一个路由去的位置，然后将消息发送到下一个路由器，即消息再次经过子网内的集线器被转发到下一个路由器。前面的过程不断重复，最终消息就被传到了目的地。这个过程就好像你准备好信件由邮局寄出，邮局寄出后会送往下一站，再由下一站判断你的目的地，再往下送一样；</p>
<p>那么这个地址到底是怎么组成的呢？</p>
<p><img src="https://gitee.com/MysticalYu/pic/raw/master/hexo/ip.png" alt="IP"></p>
<p>如上图，实际的IP地址是一串32比特的数字，按照1个字节为一组分成4组，分别用十进制表示然后再用圆点隔开。在IP地址的规则中，网络号和主机号连接起来总共是32比特，但这两部分的具体结构是不固定的。在组建网络时，用户可以自行决定他们之间的分配关系，因此，这里还需要另外的附加信息来表示IP地址的内部结构。</p>
<p>这个附加信息就是子网掩码。子网掩码的格式如下图，是一串与IP地址长度相同的32比特数字，左边一半全是1，代表网络号，右边一半全是0，代表主机号。</p>
<p><img src="https://gitee.com/MysticalYu/pic/raw/master/hexo/ipyanma.png" alt="ipyanma"></p>
<h3 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h3><p>那么要怎么得到域名对应的IP地址呢？?</p>
<p>按照开发的思路，要得到域名对应的IP地址，那肯定需要一个key-value的内存表来记录域名key对应的IP地址value，这样取出来即可，可是….这个表在哪里？</p>
<p>这就要涉及到DNS域名服务器，浏览器委托操作系统先去DNS域名服务器查询域名对应的IP地址，服务器返回需要IP，然后我们就可以用这个IP发送消息了。</p>
<p><img src="https://gitee.com/MysticalYu/pic/raw/master/hexo/mengbi2.jpg" alt="mengbi2"></p>
<p>等等！我怎么访问DNS域名服务器的？我..我怎么知道它的IP的？？</p>
<p><img src="https://gitee.com/MysticalYu/pic/raw/master/hexo/mangqu.jpeg" alt="mangqu"></p>
<p>参考<a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2016/06/dns.html">DNS 原理入门</a>以及如果你听英文可以听得懂的话 <a target="_blank" rel="noopener" href="https://aws.amazon.com/tw/route53/what-is-dns/">AWS的‘什麼是 DNS’？</a>；</p>
<p> 首先，本机一定要知道DNS服务器的IP地址，否则上不了网。通过DNS服务器，才能知道某个域名的IP地址到底是什么。  </p>
<p>DNS服务器的IP地址，有可能是动态的，每次上网时由网关分配，这叫做DHCP机制；也有可能是事先指定的固定地址。Linux系统里面，DNS服务器的IP地址保存在<code>/etc/resolv.conf</code>文件。 </p>
<p> 有一些公网的DNS服务器，也可以使用，其中最有名的就是Google的<a target="_blank" rel="noopener" href="https://developers.google.com/speed/public-dns/"><code>8.8.8.8</code></a>和Level 3的<a target="_blank" rel="noopener" href="https://www.tummy.com/articles/famous-dns-server/"><code>4.2.2.2</code></a>。 </p>
<p>在linux系统总可以使用dig match 域名 来查看使用的DNS服务器IP地址。</p>
<p> 域名的层级结构如下 ：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">主机名.次级域名.顶级域名.根域名</span><br><span class="line"></span><br><span class="line"><span class="comment"># 即</span></span><br><span class="line"></span><br><span class="line">host.sld.tld.root</span><br></pre></td></tr></table></figure>

<p> DNS服务器根据域名的层级，进行分级查询。 就是从根域名开始，依次查询每一级域名的NS记录，直到查到最终的IP地址，过程大致如下。</p>
<blockquote>
<ol>
<li>从”根域名服务器”查到”顶级域名服务器”的NS记录和A记录（IP地址）</li>
<li>从”顶级域名服务器”查到”次级域名服务器”的NS记录和A记录（IP地址）</li>
<li>从”次级域名服务器”查出”主机名”的IP地址</li>
</ol>
</blockquote>
<p> “根域名服务器”的NS记录和IP地址一般是不会变化的，所以内置在DNS服务器里面。 </p>
<p>我们只要知道连接网络需要ip地址，而域名如何解析成ip地址需要DNS域名服务器，而这个DNS域名服务器在设置网络连接的时候已经配置好，即已存在这个IP地址即可。</p>
<p>知道了对方的IP地址，要怎么才算连接呢？以编程者的思想连接如下图所示。</p>
<p><img src="https://gitee.com/MysticalYu/pic/raw/master/hexo/allConnect.png" alt="allConnect"></p>
<p>我们这里不需要知道编程怎么实现，因为不管是哪种编程它们都是在委托操作系统在发送信息，所以基本流程如下图。</p>
<p><img src="https://gitee.com/MysticalYu/pic/raw/master/hexo/simpleConnect.png" alt="simpleConnect"></p>
<p>这里解释下这张图！</p>
<p>上文中我们知道连接互联网的重任不是应用自己连接，而是委托给操作系统来执行连接，浏览器或者应用程序调用Socket发起一个连接就是一次创建Socket(FD)套接字的过程。</p>
<p>首先，分配一个内存空间用以存储套接字信息，然后，将表示这个套接字的描述符告知应用程序。</p>
<p>那何为套接字描述符呢?在这之前想考一个问题，在计算机中同一时间进行通信操作的应用程序不止一个，这时，我们就需要一种方法来识别出某个特定的套接字，这种方法就是描述符。我们可以理解描述符是给某个套接字分配的唯一编号。当我们使用某个套接字来执行收发数据的操作时，就可以出示所拥有的描述符，协议栈就能够判断出我们希望用哪一个套接字来连接或者发送数据了。在win中使用<font color= #CD5C5C>netstat</font>命令查看系统套接字内容，如下图(这张图是盗来的)：</p>
<p><img src="https://gitee.com/MysticalYu/pic/raw/master/hexo/netstat.png" alt="netstat"></p>
<p>图中每一行相当于一个套接字，当创建套接字时，就会增加一行控制信息，赋予“即将开始通信”的状态，并进行通信的准备工作，如分配用于临时存放手法数据的缓冲区空间。</p>
<p>接着Socket调用<font color= #CD6839 >connect</font>连接服务器，这个时候协议栈并不知道要和谁通信，在服务器端甚至应用程序要和谁连接都不晓得，这样下去都不知道咋整。所以，发起连接的一方需要告知被连接方一些必要的信息，比如“halo，我需要和你通奸…..哦不! 需要和你通信，这是我的房间号(ip+端口)，记得回信息哦，我在等着你呢！”。这样双方才知道互连的通信是谁，才能顺利的进行收发数据。</p>
<p>其实就是男女双方需要交换一些个性信息才好继续沟通下去。</p>
<p>那么，它们如何沟通呢？</p>
<p>需要的前提大部分已经凑齐，开始通信之前我们需要了解一下TPC/IP模型。</p>
<p> 网络模型不是一开始就有的，在网络刚发展时，网络协议是由各互联网公司自己定义的，各家的协议也是不能互通的。这样大大的阻碍了互联网的发展，为了解决这个问题，国际标准化组织 1984 提出的模型标准，简称 OSI（Open Systems Interconnection Model）。具体如下图：</p>
<p><img src="https://gitee.com/MysticalYu/pic/raw/master/hexo/v2-ad2bee0fd2abff4bf5807ca93d93cbd6_hd.jpg" alt="img"></p>
<p>OSI七层模型每一层都有自己的作用，从上到下的作用依次为：</p>
<ul>
<li>应用层(Application) :提供网络与用户应用软件之间的接口服务</li>
<li>表示层(Presentation) :提供格式化的表示和转换数据服务，如加密和压缩</li>
<li>会话层(Session) 提供包括访问验证和会话管理在内的建立和维护应用之间通信的机制</li>
<li>传输层(Transimission):提供建立、维护和取消传输连接功能，负责可靠地传输数据(PC)</li>
<li>网络层(Network): 处理网络间路由，确保数据及时传送(路由器)</li>
<li>数据链路层(DataLink): 负责无错传输数据，确认帧、发错重传等(交换机)</li>
<li>物理层(Physics) :提供机械、电气、功能和过程特性(网卡、网线、双绞线、同轴电缆、中继器)</li>
</ul>
<p>七层中应用层、表示层和会话层由软件控制，传输层、网络层和数据链路层由操作系统控制，物理层有物理设备控制。</p>
<h2 id="2-TCP-IP参考模型及协议"><a href="#2-TCP-IP参考模型及协议" class="headerlink" title="2 TCP/IP参考模型及协议"></a>2 TCP/IP参考模型及协议</h2><h2 id="1-模型"><a href="#1-模型" class="headerlink" title="1) 模型"></a>1) 模型</h2><p>TCP/IP 模型是由 OSI 模型演化而来，TCP/IP 模型将 OSI 模型由七层简化为五层（一开始为四层），应用层、表示层、会话层统一为应用层。</p>
<p><img src="https://gitee.com/MysticalYu/pic/raw/master/hexo/v2-72754ddc9c8133906ade003ad4a346d5_hd.jpg" alt="img"></p>
<h2 id="2-协议"><a href="#2-协议" class="headerlink" title="2) 协议"></a>2) 协议</h2><p>TCP/IP协议被称为传输控制协议/互联网协议，又称网络通讯协议(Transmission Control Protocol)。是由网络层的IP协议和传输层的TCP协议组成，是一个很大的协议集合。</p>
<ul>
<li>物理层和数据链路层没有定义任何特定协议，支持所有的标准和专用的协议。</li>
<li>网络层定义了网络互联也就是IP协议，主要包括IP、ARP、RARP、ICMP、IGMP。</li>
<li>传输层定义了TCP和UDP(User Datagram Protocol)，我们会后面重点介绍一下TCP协议。</li>
<li>应用层定义了HTTP(超文本传输协议)、FTP(文件传输协议)、DNS(域名系统)等协议。</li>
</ul>
<h2 id="3-物理层"><a href="#3-物理层" class="headerlink" title="3 物理层"></a>3 物理层</h2><p>计算机在传递数据的时候传递的都是0和1的数字，而物理层关心的是用什么信号来表示0和1，是否可以双向通信，最初的连接如何建立以及完成连接如何终止,总之，物理层是为数据传输提供可靠的环境。</p>
<h2 id="4-数据链路层"><a href="#4-数据链路层" class="headerlink" title="4 数据链路层"></a>4 数据链路层</h2><p>数据链路层们于物理层和网络层之间，用来向网络层提供数据，就是把源计算机网络层传过来的信息传递给目标主机。<br>数据链路层主要的作用包括：</p>
<ul>
<li>如何将数据组合成数据帧(Frame)，帧是数据链路层的传输单位</li>
<li>数据链路的建立、维护和拆除</li>
<li>帧包装、帧传输、帧同步</li>
<li>帧的差错恢复</li>
<li>流量控制</li>
</ul>
<h2 id="5-网络层"><a href="#5-网络层" class="headerlink" title="5 网络层"></a>5 网络层</h2><p>网络层位于传输层和数据链路层之间,用于把数据从源主机经过若干个中间节点传送到目标主机,并向传输层提供最基础的数据传输服务,它要提供路由和选址的工作。</p>
<p>那什么是路由和选址呢？</p>
<blockquote>
<p>选址</p>
</blockquote>
<p>交换机是靠MAC来寻址的，而因为MAC地址是无层次的,所以要靠IP地址来确认计算机的位置,这就是选址。</p>
<blockquote>
<p>路由</p>
</blockquote>
<p>在能够选择的多条道路之间选择一条最短的路径就是路由的工作。</p>
<p>路由和选址都离不开IP，我们就详细介绍一下IP头部。</p>
<h2 id="IP头"><a href="#IP头" class="headerlink" title="IP头"></a>IP头</h2><p>IP头部是由20个字节组成的，具体项所占的位数如下图：</p>
<p><img src="https://gitee.com/MysticalYu/pic/raw/master/hexo/v2-7060962aca6abdc95435330415f968fa_hd.jpg" alt="img"></p>
<p>具体的数据我们用Wireshark来表抓取一下，如图（蓝色部分为IP数据包）：</p>
<p><img src="https://gitee.com/MysticalYu/pic/raw/master/hexo/v2-489d57b43d9b4c6d2535eeeb60cc7f3f_hd.jpg" alt="img"></p>
<blockquote>
<p>version - 版本</p>
<p>Header Length - 首部长部</p>
<p>Differentiated Services Field - 优先级与服务类型</p>
<p>Total Length - 总长度，该字段用以指示整个IP数据包的长度，最长为65535字节，包括头和数据。</p>
<p>Identification - 标识符，唯一标识主机发送的每一份数据报。</p>
<p>Flags - 标志。分为3个字段，依次为保留位、不分片位和更多片位</p>
<p>Fragment offset - 段偏移量。该分片相对于原始数据报开始处位置的偏移量。</p>
<p>TTL(Time to Live生存时间) - 该字段用于表示IP数据包的生命周期，可以防止一个数据包在网络中无限循环地发下去。TTL的意思是一个数据包在被丢弃之前在网络中的最大周转时间。该数据包经过的每一个路由器都会检查该字段中的值，当TTL的值为0时此数据包会被丢弃。TTL对应于一个数据包通过路由器的数目，一个数据包每经过一个路由器，TTL将减去1。</p>
<p>Protocol - 协议号。用以指示IP数据包中封装的是哪个协议。</p>
<p>Header checksum - 首部校验和。检验和是16位的错误检测字段。目的主机和网络中的每个网关都要重新计算报头的校验和，如果一样表示没有改动过。</p>
<p>Source - 源IP地址。该字段用于表示数据包的源地址，指的是发送该数据包的设备的网络地址。</p>
<p>Destination - 目标IP地址。该字段用于表示数据包的目标的地址，指的是接收节点的网络地址。</p>
</blockquote>
<h2 id="6-传输层"><a href="#6-传输层" class="headerlink" title="6 传输层"></a>6 传输层</h2><p>传输层是面向连接的、可靠的的进程到进程通信的协议。TCP提供全双工服务，即数据可在同一时间双向传播。TCP将若干个字节构成一个分组，此分组称为报文段(Segment)。提供了一种端到端的连接。</p>
<p>传输层的协议主要有TCP 和 UDP，TCP(Transimision Control Protocal)是一种可靠的、面向连接的协议，传输效率低。UDP(User Datagram Protocal)是一种不可靠的、无连接的服务，传输效率高。<br>下面重点介绍一下TCP的三次握手和四次挥手。</p>
<h2 id="1-TCP的功能"><a href="#1-TCP的功能" class="headerlink" title="1) TCP的功能"></a>1) TCP的功能</h2><p>TCP主要是将数据进行分段打包传输，对每个数据包编号控制顺序，运输中丢失、重发和丢弃处理。</p>
<h2 id="2-TCP头的介绍"><a href="#2-TCP头的介绍" class="headerlink" title="2) TCP头的介绍"></a>2) TCP头的介绍</h2><p>有点和IP头类似，我们先来张图看下：</p>
<p><img src="https://gitee.com/MysticalYu/pic/raw/master/hexo/v2-8caac8f1477e7e0848743f8a9c1d91ba_hd.jpg" alt="img"></p>
<blockquote>
<p>Source Port &amp; Destination Port - 源端口号和目标端口号;计算机通过端口号识别访问哪个服务,比如http服务或ftp服务;发送方端口号是进行随机端口;目标端口号决定了接收方哪个程序来接收。</p>
<p>Sequence number - 32位序列号，TCP用序列号对数据包进行标记，以便在到达目的地后重新重装。在建立连接时通常由计算机生成一个随机数作为序列号的初始值。</p>
<p>Acknowledgment number - 32位确认号，确认应答号。发送端接收到这个确认应答后，可以认为这个位置以前所有的数据都已被正常接收。</p>
<p>Header Length - 首部长度。单位是 ‘4’个’字节’，如果没有可选字段，那么这里的值就是 5。表示 TCP 首部的长度为 20 字节。</p>
<p>checksum - 16位校验和。用来做差错控制，TCP校验和的计算包括TCP首部、数据和其它填充字节。</p>
<p>flags - 控制位。TCP的连接、传输和断开都受这六个控制位的指挥</p>
<p>window size - 本地可接收数据的数目，这个值的大小是可变的。当网络通畅时将这个窗口值变大加快传输速度，当网络不稳定时减少这个值可以保证网络数据的可靠传输。它是来在TCP传输中进行流量控制的</p>
</blockquote>
<h2 id="3-传说中的三次握手和四次挥手（抓包演示）"><a href="#3-传说中的三次握手和四次挥手（抓包演示）" class="headerlink" title="3) 传说中的三次握手和四次挥手（抓包演示）"></a>3) 传说中的三次握手和四次挥手（抓包演示）</h2><p>三次握手和四次挥手到底是怎么回事呢，我用一台主机A（172.16.50.72:65076）起一个服务，另外一台主机B（172.16.17.94:8080）请求一下。<br>在A主机上启动node服务：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> url = <span class="built_in">require</span>(<span class="string">&#x27;url&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> server = http.createServer();</span><br><span class="line">server.on(<span class="string">&#x27;request&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> &#123;pathname, querry&#125; = url.parse(req.url, <span class="literal">true</span>);</span><br><span class="line">    <span class="keyword">let</span> result = [];</span><br><span class="line">    req.on(<span class="string">&#x27;data&#x27;</span>, <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">        result.push(data);</span><br><span class="line">    &#125;)</span><br><span class="line">    req.on(<span class="string">&#x27;end&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(Buffer.concat(result).toString());</span><br><span class="line">        res.end(<span class="string">&#x27;hello world&#x27;</span>);</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line">server.listen(<span class="number">8080</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;server started&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<p>B主机连接A并发送数据：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -d &quot;user&quot;:&quot;lucy&quot; 172.16.17.94:8080</span><br></pre></td></tr></table></figure>

<p>用wireshark抓包演示一下。如下图：</p>
<p><img src="https://gitee.com/MysticalYu/pic/raw/master/hexo/v2-ae1b0c298e03963eab3fc23847a6ef20_hd.jpg" alt="img"></p>
<p>上图中A为三次握手，B为数据传输，C为四次挥手。下面我们详细介绍一下这三个部分。</p>
<p>首先我们先图解一下wireshark抓到的数据，如下图：</p>
<p><img src="https://gitee.com/MysticalYu/pic/raw/master/hexo/v2-4d7cd156319c914e115b19ee15e70063_hd.jpg" alt="img"></p>
<p>我们把这个过程分为三部分，第一部分为三次握手建立连接，第二部分为数据传输，第三次为四次挥手断开连接。</p>
<p>三次握手</p>
<p>我们分析一下三次握手的过程（包括ack 和 seq的值变化）。</p>
<p><img src="https://gitee.com/MysticalYu/pic/raw/master/hexo/v2-b93fef4ca387c4aa50071dad72fc2085_hd.jpg" alt="img"></p>
<p>为了方便描述我们将主动发起请求的172.16.17.94:8080 主机称为客户端，将返回数据的主机172.16.17.94:8080称为服务器，以下也是。</p>
<ul>
<li>第一次握手: 建立连接。客户端发送连接请求，发送SYN报文，将seq设置为0。然后，客户端进入SYN_SEND状态，等待服务器的确认。</li>
<li>第二次握手: 服务器收到客户端的SYN报文段。需要对这个SYN报文段进行确认，发送ACK报文，将ack设置为1。同时，自己还要发送SYN请求信息，将seq为0。服务器端将上述所有信息一并发送给客户端，此时服务器进入SYN_RECV状态。</li>
<li>第三次握手: 客户端收到服务器的ACK和SYN报文后，进行确认，然后将ack设置为1，seq设置为1，向服务器发送ACK报文段，这个报文段发送完毕以后，客户端和服务器端都进入ESTABLISHED状态，完成TCP三次握手。</li>
</ul>
<blockquote>
<p>数据传输</p>
</blockquote>
<p><img src="https://gitee.com/MysticalYu/pic/raw/master/hexo/v2-325456c5c7054ee6b29795a684cbbffb_hd.jpg" alt="img"></p>
<ul>
<li>客户端先向服务器发送数据，该数据报是lenth为159的数据。</li>
<li>服务器收到报文后, 也向客户端发送了一个数据进行确认（ACK），并且返回客户端要请求的数据，数据的长度为111，将seq设置为1，ack设置为160（1 + 159）。</li>
<li>客户端收到服务器返回的数据后进行确认（ACK），将seq设置为160， ack设置为112（1 + 111）。</li>
</ul>
<blockquote>
<p>四次挥手</p>
</blockquote>
<p>当客户端和服务器通过三次握手建立了TCP连接以后，当数据传送完毕，就要断开TCP连接了，就有了神秘的“四次挥手”。</p>
<p><img src="https://gitee.com/MysticalYu/pic/raw/master/hexo/v2-6704e393bd622132d3dac3773412ec26_hd.jpg" alt="img"></p>
<ul>
<li>第一次挥手：客户端向服务器发送一个FIN报文段，将设置seq为160和ack为112，;此时，客户端进入 <strong>FIN_WAIT_1</strong>状态,这表示客户端没有数据要发送服务器了，请求关闭连接;</li>
<li>第二次挥手：服务器收到了客户端发送的FIN报文段，向客户端回一个ACK报文段，ack设置为1，seq设置为112;服务器进入了<strong>CLOSE_WAIT</strong>状态，客户端收到服务器返回的ACK报文后，进入<strong>FIN_WAIT_2</strong>状态;</li>
<li>第三次挥手：服务器会观察自己是否还有数据没有发送给客户端，如果有，先把数据发送给客户端，再发送FIN报文；如果没有，那么服务器直接发送FIN报文给客户端。请求关闭连接，同时服务器进入<strong>LAST_ACK</strong>状态;</li>
<li>第四次挥手：客户端收到服务器发送的FIN报文段，向服务器发送ACK报文段，将seq设置为161，将ack设置为113，然后客户端进入<strong>TIME_WAIT</strong>状态;服务器收到客户端的ACK报文段以后，就关闭连接;此时，客户端等待2MSL后依然没有收到回复，则证明Server端已正常关闭，客户端也可以关闭连接了。</li>
</ul>
<p>注意：在握手和挥手时确认号应该是对方序列号加1,传输数据时则是对方序列号加上对方携带应用层数据的长度。</p>
<h2 id="7-应用层"><a href="#7-应用层" class="headerlink" title="7 应用层"></a>7 应用层</h2><p>应用层常见协议有HTTP、HTTPS 、FTP 、SMTP等。</p>
<p>TCP/IP模型我们基本介绍完了，那层与层之间是怎样合作和分工的呢，我们用两张图介绍一下：<br>发送方的数据是从上往下传输的，即从应用层向物理层传输。接收方的数据是从下往上传输的，即从物理层向应用层传输。如下两张图。</p>
<p><img src="https://gitee.com/MysticalYu/pic/raw/master/hexo/v2-fddf614d20e94c08a02861297fb95a99_hd.jpg" alt="img"></p>
<p>发送方是从高层到低层封装数据：</p>
<ul>
<li>在应用层要把各式各样的数据如字母、数字、汉字、图片等转换成二进制</li>
<li>在TCP传输层中，上层的数据被分割成小的数据段，并为每个分段后的数据封装TCP报文头部</li>
<li>在TCP头部有一个关键的字段信息端口号，它用于标识上层的协议或应用程序，确保上层数据的正常通信</li>
<li>计算机可以多进程并发运行，例如在发邮件的同时也可以通过浏览器浏览网页，这两种应用通过端口号进行区分</li>
<li>在网络层，上层数据被封装上亲的报文头部(IP头部)，上层的数据是包括TCP头部的。IP地址包括的最关键字段信息就是IP地址，用于标识网络的逻辑地址。</li>
<li>数据链路径层，上层数据成一个MAC头部，内部有最关键的是MAC地址。MAC地址就是固化在硬件设备内部的全球唯一的物理地址。</li>
<li>在物理层，无论在之前哪一层封装的报文头和还是上层数据都是由二进制组成的，物理将这些二进制数字比特流转换成电信号在网络中传输</li>
</ul>
<p><img src="https://gitee.com/MysticalYu/pic/raw/master/hexo/v2-1ede5aa9c734a98c0d9c259cd92308fe_hd.jpg" alt="img"></p>
<p>接收方是从低层到高层解封装</p>
<ul>
<li>数据封装完毕传输到接收方后，将数据要进行解封装</li>
<li>在物理层，先把电信号转成二进制数据，并将数据传送至数据链路层</li>
<li>在数据链路层，把MAC头部拆掉，并将剩余的数据传送至上一层</li>
<li>在网络层，数据的IP头部被拆掉，并将剩余的数据送至上一层</li>
<li>在传输层，把TCP头部拆掉，将真实的数据传送至应用层</li>
</ul>
<p><strong>我严重怀疑你在拖文章长度</strong></p>
<p> <img src="https://gitee.com/MysticalYu/pic/raw/master/hexo/ganga.jpeg" alt="尴尬表情包"> </p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">MysticalYcc</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://gschaos.club/connect/">https://gschaos.club/connect/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://gschaos.club" target="_blank">MysticalYcc</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a></div><div class="post_share"><div class="social-share" data-image="https://mysticalyu.gitee.io/pic/img/20200407233909-www-ycfcg-com-2(4).jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/proxy/"><img class="prev-cover" src="https://mysticalyu.gitee.io/pic/img/cat-lazy-fengmian.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">动态代理在代码中的应用</div></div></a></div><div class="next-post pull-right"><a href="/YouTube/"><img class="next-cover" src="https://mysticalyu.gitee.io/pic/img/jonathan-romeo-orihime-v2.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">如何在YouTube Api限额的情况下获取更多视频</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></article></main><footer id="footer" style="background-image: url(https://mysticalyu.gitee.io/pic/img/20200407233909-www-ycfcg-com-2(4).jpg)"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By MysticalYcc</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="icp"><a target="_blank" rel="noopener" href="http://www.beian.miit.gov.cn/state/outPortal/loginPortal.action"><img class="icp-icon" src="/img/icp.png"/><span>皖ICP备19015872号-1</span></a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> {preloader.endLoading()})</script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const initData = {
      el: '#vcomment',
      appId: 'J2f6Gx43ptrGYdf1rHPAS5sJ-gzGzoHsz',
      appKey: 'cSywIQR7CfBFaNI8iiPTYy41',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'en',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
    }

    if (true) { 
      initData.requiredFields= ('nick,mail'.split(','))
    }

    const valine = new Valine(initData)
  }

  if (typeof Valine === 'function') initValine() 
  else $.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.querySelector('#vcomment'),loadValine)
  else setTimeout(() => loadValine(), 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.17.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<[^>]+>/g,"") // remove html tag
    content = content.replace(/(http(s?):)([/|.|\w|\s|-])*\.(?:jpg|jpeg|gif|png|webp)/g, '') // remove image link
    content = content.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi, '') // remove url

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getIcon = (icon, mail) => {
    if (icon) return icon 
    let defaultIcon = ''
    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`
    return iconUrl
  }

  const generateHtml = array => {
    let result = ''

    for (let i = 0; i < array.length; i++) {
      result += '<div class=\'aside-list-item\'>'

      if (true) {
        result += `<a href='${array[i].url}' class="thumbnail"><img src='${getIcon(array[i].avatar, array[i].mail)}' alt='${array[i].nick}'></a>`
      }

      result += `<div class='content'>
      <a class='comment' href='${array[i].url}'>${array[i].content}</a>
      <div class='name'><span>${array[i].nick}</span><time> / ${btf.diffDate(array[i].date, true)}</time></div>
      </div></div>`
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.pjax && window.pjax.refresh($dom)
  }

  const getValineData = () => {
      let serverURL = ''
      if (true) {
        serverURL = 'https://j2f6gx43.lc-cn-n1-shared.com'
      } else {
        serverURL = 'https://J2f6Gx43.api.lncldglobal.com'
      }

    var settings = {
      "url": `${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,
      "method": "GET",
      "timeout": 0,
      "headers": {
        "X-LC-Id": 'J2f6Gx43ptrGYdf1rHPAS5sJ-gzGzoHsz',
        "X-LC-Key": 'cSywIQR7CfBFaNI8iiPTYy41',
        "Content-Type": "application/json"
      },
    }

    $.ajax(settings).done((response) => {
      var valineArray = []
      response.results.forEach((e)=>{
        valineArray.push({
          'avatar': e.QQAvatar,
          'content': changeContent(e.comment),
          'mail': e.mail,
          'nick': e.nick,
          'url': e.url,
          'date': e.createdAt,
        })
      })
      
      saveToLocal.set('leancloud-newest-comments', JSON.stringify(valineArray), 10/(60*24))
      generateHtml(valineArray)

    }).fail(()=>{
      const $dom = document.querySelector('#card-newest-comments .aside-list')
      $dom.innerHTML= "无法获取资料，请确认相关配置是否正确"
    })
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('leancloud-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getValineData()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><div class="aplayer no-destroy" data-id="2920702828" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="true" muted></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  'meta[name=description]',
  '#config_change',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  $('script[data-pjax]').each(function () {
    $(this).parent().append($(this).remove())
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  if (typeof gtag === 'function') {
    gtag('config', '', {'page_path': window.location.pathname});
  }

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})


document.addEventListener('pjax:send', function () {
  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  $(window).off('scroll')

  //reset readmode
  $('body').hasClass('read-mode') && $('body').removeClass('read-mode')

})</script></div></body></html>